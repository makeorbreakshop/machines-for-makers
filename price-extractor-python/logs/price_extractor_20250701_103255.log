2025-07-01 10:32:55 | INFO     | services.database:__init__:21 - Database service initialized
2025-07-01 10:32:55 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-07-01 10:32:55 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-07-01 10:32:55 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-07-01 10:33:16 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-07-01 10:33:17 | INFO     | services.database:get_machines_needing_update:264 - Found 149 machines for price update
2025-07-01 10:33:18 | INFO     | api.routes:batch_update_machines:115 - Batch update request with days=7, limit=10, machine_ids=['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e4093bf6-7a1c-4325-9094-8c572a307459', 'b2956e47-a9da-4359-8c88-42ca9a8740e7', 'fad976a4-4bb9-4c91-92c3-ff774f02ec16']
2025-07-01 10:33:18 | INFO     | services.price_service:batch_update_machines:202 - Starting batch update with days_threshold=7, limit=10, machine_ids=10
2025-07-01 10:33:18 | INFO     | services.price_service:batch_update_machines:206 - Using 10 provided machine IDs for batch update
2025-07-01 10:33:19 | INFO     | services.database:get_machines_needing_update:288 - Found 10 machines for price update
2025-07-01 10:33:19 | INFO     | services.price_service:batch_update_machines:217 - Starting batch update for 10 machines
2025-07-01 10:33:19 | INFO     | services.database:create_batch:339 - Creating new batch with ID 3ea372ef-92e7-4274-aec1-98ac680d1531 for 10 machines
2025-07-01 10:33:19 | INFO     | services.database:create_batch:369 - Successfully created batch record with ID 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:19 | INFO     | services.database:create_batch:379 - Verified batch 3ea372ef-92e7-4274-aec1-98ac680d1531 exists in database
2025-07-01 10:33:19 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 103db02f-7852-41f8-b297-162d479eaa39
2025-07-01 10:33:19 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc
2025-07-01 10:33:19 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc in 0.30 seconds
2025-07-01 10:33:19 | INFO     | scrapers.price_extractor:_extract_from_common_selectors:244 - Extracted price 2399.0 using selector '.price'
2025-07-01 10:33:20 | INFO     | services.database:update_machine_price:131 - Updated price for machine 103db02f-7852-41f8-b297-162d479eaa39 to 2399.0
2025-07-01 10:33:20 | INFO     | services.database:add_price_history:195 - Added price history entry for machine 103db02f-7852-41f8-b297-162d479eaa39
2025-07-01 10:33:20 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine 103db02f-7852-41f8-b297-162d479eaa39 from 1399 to 2399.0 using CSS Selector '.price'
2025-07-01 10:33:20 | INFO     | services.database:add_batch_result:484 - Added result for machine 103db02f-7852-41f8-b297-162d479eaa39 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:20 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93
2025-07-01 10:33:20 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc
2025-07-01 10:33:21 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc in 0.13 seconds
2025-07-01 10:33:21 | INFO     | scrapers.price_extractor:_extract_from_common_selectors:244 - Extracted price 1999.0 using selector '.price'
2025-07-01 10:33:22 | INFO     | services.database:update_machine_price:131 - Updated price for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93 to 1999.0
2025-07-01 10:33:22 | INFO     | services.database:add_price_history:195 - Added price history entry for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93
2025-07-01 10:33:22 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93 from 6666 to 1999.0 using CSS Selector '.price'
2025-07-01 10:33:22 | INFO     | services.database:add_batch_result:484 - Added result for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:22 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-07-01 10:33:22 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:298 - Found 20 batch jobs
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '3ea372ef-92e7-4274-aec1-98ac680d1531', 'status': 'started', 'start_time': '2025-07-01T10:33:19.004577+00:00', 'end_time': None, 'total_machines': 10, 'days_threshold': 7}
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:298 - Found 20 batch jobs
2025-07-01 10:33:22 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '3ea372ef-92e7-4274-aec1-98ac680d1531', 'status': 'started', 'start_time': '2025-07-01T10:33:19.004577+00:00', 'end_time': None, 'total_machines': 10, 'days_threshold': 7}
2025-07-01 10:33:22 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742 in 0.33 seconds
2025-07-01 10:33:22 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 139.0 using JSON-LD
2025-07-01 10:33:24 | INFO     | services.database:update_machine_price:131 - Updated price for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c to 139.0
2025-07-01 10:33:24 | INFO     | services.database:add_price_history:195 - Added price history entry for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-07-01 10:33:24 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c from 169 to 139.0 using JSON-LD
2025-07-01 10:33:24 | INFO     | services.database:add_batch_result:484 - Added result for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:24 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-07-01 10:33:24 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://aeonlaser.us/mira-s
2025-07-01 10:33:24 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://aeonlaser.us/mira-s in 0.23 seconds
2025-07-01 10:33:24 | INFO     | scrapers.price_extractor:_extract_from_structured_data:135 - Extracted parsed price 699.0 using JSON-LD
2025-07-01 10:33:25 | INFO     | services.database:update_machine_price:131 - Updated price for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 to 699.0
2025-07-01 10:33:25 | INFO     | services.database:add_price_history:195 - Added price history entry for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-07-01 10:33:25 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 from 6995 to 699.0 using JSON-LD
2025-07-01 10:33:25 | INFO     | services.database:add_batch_result:484 - Added result for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:25 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-07-01 10:33:25 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-07-01 10:33:26 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum in 0.77 seconds
2025-07-01 10:33:26 | INFO     | scrapers.price_extractor:_extract_from_structured_data:171 - Extracted price 2099.99 using JSON-LD offers array
2025-07-01 10:33:27 | INFO     | services.database:update_machine_price:131 - Updated price for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 to 2099.99
2025-07-01 10:33:27 | INFO     | services.database:add_price_history:195 - Added price history entry for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-07-01 10:33:27 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 from 2199.99 to 2099.99 using JSON-LD offers
2025-07-01 10:33:27 | INFO     | services.database:add_batch_result:484 - Added result for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:27 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-07-01 10:33:27 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-07-01 10:33:28 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.20 seconds
2025-07-01 10:33:28 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 1099.0 using JSON-LD
2025-07-01 10:33:29 | INFO     | services.database:update_machine_price:131 - Updated price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 to 1099.0
2025-07-01 10:33:30 | INFO     | services.database:add_price_history:195 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-07-01 10:33:30 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 from 1299.0 to 1099.0 using JSON-LD
2025-07-01 10:33:30 | INFO     | services.database:add_batch_result:484 - Added result for machine c23808f6-1760-4cad-b031-3c5eb3556d98 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:30 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-07-01 10:33:30 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://aeonlaser.us/nova-s
2025-07-01 10:33:30 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://aeonlaser.us/nova-s in 0.10 seconds
2025-07-01 10:33:30 | INFO     | scrapers.price_extractor:_extract_from_structured_data:135 - Extracted parsed price 179.0 using JSON-LD
2025-07-01 10:33:30 | INFO     | services.database:update_machine_price:131 - Updated price for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f to 179.0
2025-07-01 10:33:30 | INFO     | services.database:add_price_history:195 - Added price history entry for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-07-01 10:33:30 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f from 17995 to 179.0 using JSON-LD
2025-07-01 10:33:30 | INFO     | services.database:add_batch_result:484 - Added result for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:30 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-07-01 10:33:31 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-07-01 10:33:31 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739 in 0.16 seconds
2025-07-01 10:33:31 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 299.0 using JSON-LD
2025-07-01 10:33:32 | INFO     | services.database:update_machine_price:131 - Updated price for machine e4093bf6-7a1c-4325-9094-8c572a307459 to 299.0
2025-07-01 10:33:32 | INFO     | services.database:add_price_history:195 - Added price history entry for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-07-01 10:33:32 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine e4093bf6-7a1c-4325-9094-8c572a307459 from 339.0 to 299.0 using JSON-LD
2025-07-01 10:33:33 | INFO     | services.database:add_batch_result:484 - Added result for machine e4093bf6-7a1c-4325-9094-8c572a307459 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:33 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-07-01 10:33:33 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://aeonlaser.us/supernova-s
2025-07-01 10:33:33 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://aeonlaser.us/supernova-s in 0.13 seconds
2025-07-01 10:33:33 | INFO     | scrapers.price_extractor:_extract_from_structured_data:135 - Extracted parsed price 254.0 using JSON-LD
2025-07-01 10:33:33 | INFO     | services.database:update_machine_price:131 - Updated price for machine ef4f7a07-a068-4afc-b550-22d101c6e68b to 254.0
2025-07-01 10:33:33 | INFO     | services.database:add_price_history:195 - Added price history entry for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-07-01 10:33:33 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine ef4f7a07-a068-4afc-b550-22d101c6e68b from 25495.0 to 254.0 using JSON-LD
2025-07-01 10:33:33 | INFO     | services.database:add_batch_result:484 - Added result for machine ef4f7a07-a068-4afc-b550-22d101c6e68b to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:33 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-07-01 10:33:34 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-07-01 10:33:34 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser in 0.17 seconds
2025-07-01 10:33:34 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 629.0 using JSON-LD
2025-07-01 10:33:35 | INFO     | services.database:update_machine_price:131 - Updated price for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 to 629.0
2025-07-01 10:33:35 | INFO     | services.database:add_price_history:195 - Added price history entry for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-07-01 10:33:35 | INFO     | services.price_service:update_machine_price:162 - Successfully updated price for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 from 649.0 to 629.0 using JSON-LD
2025-07-01 10:33:36 | INFO     | services.database:add_batch_result:484 - Added result for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 to batch 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:33:36 | INFO     | services.database:complete_batch:413 - Marked batch 3ea372ef-92e7-4274-aec1-98ac680d1531 as completed
2025-07-01 10:33:36 | INFO     | services.price_service:batch_update_machines:266 - Batch update completed. Results: 10 successful, 0 failed
2025-07-01 10:34:22 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-07-01 10:34:22 | INFO     | api.routes:get_batches:298 - Found 20 batch jobs
2025-07-01 10:34:22 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '3ea372ef-92e7-4274-aec1-98ac680d1531', 'status': 'completed', 'start_time': '2025-07-01T10:33:19.004577+00:00', 'end_time': '2025-07-01T10:33:36.097203+00:00', 'total_machines': 10, 'days_threshold': 7}
2025-07-01 10:34:26 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:34:26 | INFO     | services.price_service:get_batch_results:285 - Retrieving batch results for batch_id: 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:34:26 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:34:26 | INFO     | services.price_service:get_batch_results:285 - Retrieving batch results for batch_id: 3ea372ef-92e7-4274-aec1-98ac680d1531
2025-07-01 10:34:58 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-07-01 10:34:58 | INFO     | services.database:get_machines_needing_update:264 - Found 139 machines for price update
2025-07-01 10:34:58 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-07-01 10:34:59 | INFO     | api.routes:get_batches:298 - Found 20 batch jobs
2025-07-01 10:34:59 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '3ea372ef-92e7-4274-aec1-98ac680d1531', 'status': 'completed', 'start_time': '2025-07-01T10:33:19.004577+00:00', 'end_time': '2025-07-01T10:33:36.097203+00:00', 'total_machines': 10, 'days_threshold': 7}
2025-07-01 10:47:23 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-07-01 10:47:24 | INFO     | api.routes:get_batches:298 - Found 20 batch jobs
2025-07-01 10:47:24 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': 'da915577-2593-4d43-8ea0-328bf814a24e', 'status': 'completed', 'start_time': '2025-07-01T10:22:41.288182+00:00', 'end_time': '2025-07-01T10:22:59.809587+00:00', 'total_machines': 10, 'days_threshold': 7}
2025-07-01 10:47:24 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-07-01 10:47:24 | INFO     | services.database:get_machines_needing_update:264 - Found 139 machines for price update
