2025-04-16 11:26:27 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:26:27 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:26:27 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:26:27 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:28:28 | INFO     | api.routes:get_batch_results:101 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | INFO     | services.price_service:get_batch_results:193 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | ERROR    | services.database:get_batch_results:290 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: [Errno 8] nodename nor servname provided, or not known
2025-04-16 11:28:28 | WARNING  | services.price_service:get_batch_results:200 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | WARNING  | api.routes:get_batch_results:108 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | INFO     | api.routes:get_batch_results:101 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | INFO     | services.price_service:get_batch_results:193 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | ERROR    | services.database:get_batch_results:290 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: [Errno 8] nodename nor servname provided, or not known
2025-04-16 11:28:28 | WARNING  | services.price_service:get_batch_results:200 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:28:28 | WARNING  | api.routes:get_batch_results:108 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | INFO     | api.routes:get_batch_results:101 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | INFO     | services.price_service:get_batch_results:193 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | ERROR    | services.database:get_batch_results:290 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: [Errno 8] nodename nor servname provided, or not known
2025-04-16 11:30:08 | WARNING  | services.price_service:get_batch_results:200 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | WARNING  | api.routes:get_batch_results:108 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | INFO     | api.routes:get_batch_results:101 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | INFO     | services.price_service:get_batch_results:193 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | ERROR    | services.database:get_batch_results:290 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: [Errno 8] nodename nor servname provided, or not known
2025-04-16 11:30:08 | WARNING  | services.price_service:get_batch_results:200 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:30:08 | WARNING  | api.routes:get_batch_results:108 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:31:06 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:31:06 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:31:06 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:31:06 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:31:28 | INFO     | api.routes:update_machine_price:38 - Received price update request for machine 163b26bb-b096-4473-9a17-569c1cfb4f18
2025-04-16 11:31:28 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 163b26bb-b096-4473-9a17-569c1cfb4f18
2025-04-16 11:31:28 | ERROR    | services.price_service:update_machine_price:41 - Invalid or missing URL for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: None
2025-04-16 11:31:28 | ERROR    | api.routes:update_machine_price:43 - Price update failed for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: Invalid or missing URL for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: None
2025-04-16 11:31:28 | ERROR    | api.routes:update_machine_price:48 - Error updating price for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: 400: Invalid or missing URL for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: None
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x1113e7560>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10575b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x1057b8540>
    └ <uvicorn.server.Server object at 0x1113fb490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1057b85e0>
           │       │   └ <uvicorn.server.Server object at 0x1113fb490>
           │       └ <function run at 0x104fa8e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1113967a0>
           │      └ <function Runner.run at 0x105010720>
           └ <asyncio.runners.Runner object at 0x1116284d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x1116325a0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1116284d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111667e50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e6010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1116c6ed0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111667e50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e6010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e6010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1116e4450>
          └ <fastapi.applications.FastAPI object at 0x1116c6ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1116d36a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1116e4450>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '53', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1116d36a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x107495760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11161fb10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1116e5110>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1116c7490>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11161fb10>
          └ <function wrap_app_handling_exceptions at 0x1073e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1116c7490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1116c7490>>
          └ <fastapi.routing.APIRouter object at 0x1116c7490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1073e1da0>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1116d2980>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1116e4dd0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1116d3920>
          └ <function wrap_app_handling_exceptions at 0x1073e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e60...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1116d3920>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1116e4dd0>
                     └ <function get_request_handler.<locals>.app at 0x1116d27a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1073e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': MachineUpdateRequest(machine_id='163b26bb-b096-4473-9a17-569c1cfb4f18')}
                 │         └ <function update_machine_price at 0x1113e68e0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 44, in update_machine_price
    raise HTTPException(status_code=400, detail=result.get("error", "Price update failed"))
          │                                     │      └ <method 'get' of 'dict' objects>
          │                                     └ {'success': False, 'error': 'Invalid or missing URL for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: None'}
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Invalid or missing URL for machine 163b26bb-b096-4473-9a17-569c1cfb4f18: None
2025-04-16 11:33:25 | INFO     | api.routes:update_machine_price:38 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:33:25 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:33:26 | ERROR    | services.price_service:update_machine_price:41 - Invalid or missing URL for machine 8054eeb8-504f-4791-9f48-a99fe0669664: None
2025-04-16 11:33:26 | ERROR    | api.routes:update_machine_price:43 - Price update failed for machine 8054eeb8-504f-4791-9f48-a99fe0669664: Invalid or missing URL for machine 8054eeb8-504f-4791-9f48-a99fe0669664: None
2025-04-16 11:33:26 | ERROR    | api.routes:update_machine_price:48 - Error updating price for machine 8054eeb8-504f-4791-9f48-a99fe0669664: 400: Invalid or missing URL for machine 8054eeb8-504f-4791-9f48-a99fe0669664: None
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x1113e7560>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10575b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x1057b8540>
    └ <uvicorn.server.Server object at 0x1113fb490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1057b85e0>
           │       │   └ <uvicorn.server.Server object at 0x1113fb490>
           │       └ <function run at 0x104fa8e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1113967a0>
           │      └ <function Runner.run at 0x105010720>
           └ <asyncio.runners.Runner object at 0x1116284d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x1116325a0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1116284d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111667e50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1116c6ed0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111667e50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1116e4450>
          └ <fastapi.applications.FastAPI object at 0x1116c6ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1116d37e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1116e4450>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '53', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1116d37e0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x107495760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11161fb10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1116dbb10>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1116e5410>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1116c7490>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11161fb10>
          └ <function wrap_app_handling_exceptions at 0x1073e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1116c7490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1116c7490>>
          └ <fastapi.routing.APIRouter object at 0x1116c7490>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1073e1da0>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1116d2980>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3880>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1116e8d50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1116d3920>
          └ <function wrap_app_handling_exceptions at 0x1073e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1116d3a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1116e4f...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1116d3920>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1116e8d50>
                     └ <function get_request_handler.<locals>.app at 0x1116d27a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1073e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': MachineUpdateRequest(machine_id='8054eeb8-504f-4791-9f48-a99fe0669664')}
                 │         └ <function update_machine_price at 0x1113e68e0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 44, in update_machine_price
    raise HTTPException(status_code=400, detail=result.get("error", "Price update failed"))
          │                                     │      └ <method 'get' of 'dict' objects>
          │                                     └ {'success': False, 'error': 'Invalid or missing URL for machine 8054eeb8-504f-4791-9f48-a99fe0669664: None'}
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Invalid or missing URL for machine 8054eeb8-504f-4791-9f48-a99fe0669664: None
2025-04-16 11:34:52 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:34:52 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:34:52 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:34:52 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:35:03 | INFO     | api.routes:update_machine_price:38 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:35:03 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:35:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 11:35:05 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.81 seconds
2025-04-16 11:35:05 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 1199.0 using JSON-LD
2025-04-16 11:35:07 | WARNING  | services.database:update_machine_price:74 - No machine found with ID 8054eeb8-504f-4791-9f48-a99fe0669664 to update
2025-04-16 11:35:07 | ERROR    | services.price_service:update_machine_price:102 - Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:35:07 | ERROR    | api.routes:update_machine_price:43 - Price update failed for machine 8054eeb8-504f-4791-9f48-a99fe0669664: Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:35:07 | ERROR    | api.routes:update_machine_price:48 - Error updating price for machine 8054eeb8-504f-4791-9f48-a99fe0669664: 400: Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x1138f3560>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x1067632e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x107368540>
    └ <uvicorn.server.Server object at 0x113a288d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1073685e0>
           │       │   └ <uvicorn.server.Server object at 0x113a288d0>
           │       └ <function run at 0x106420e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1138967a0>
           │      └ <function Runner.run at 0x10648c720>
           └ <asyncio.runners.Runner object at 0x113a28990>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x113a32670>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x113a28990>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x113a80250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x113abf410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x113a80250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x113ae8650>
          └ <fastapi.applications.FastAPI object at 0x113abf410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x113ad7740>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x113a1a410>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x113ae8650>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '53', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x113ad7740>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x110d95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x113a1a410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x113a1a410>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x113a18e10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x113a1a410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x113a1a410>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x113ae9010>
          │                            │    └ <fastapi.routing.APIRouter object at 0x113abf950>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x113a18e10>
          └ <function wrap_app_handling_exceptions at 0x110ce07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7880>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x113abf950>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7880>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x113abf950>>
          └ <fastapi.routing.APIRouter object at 0x113abf950>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7880>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x110ce1da0>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7880>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x113ad6980>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7880>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x113ae8fd0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x113ad7920>
          └ <function wrap_app_handling_exceptions at 0x110ce07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x113ad7a60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x113ae9e...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x113ad7920>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x113ae8fd0>
                     └ <function get_request_handler.<locals>.app at 0x113ad67a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x110ce18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': MachineUpdateRequest(machine_id='8054eeb8-504f-4791-9f48-a99fe0669664')}
                 │         └ <function update_machine_price at 0x1138f28e0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 44, in update_machine_price
    raise HTTPException(status_code=400, detail=result.get("error", "Price update failed"))
          │                                     │      └ <method 'get' of 'dict' objects>
          │                                     └ {'success': False, 'error': 'Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664'}
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:38:45 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:38:45 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:38:45 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:38:45 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:38:54 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:38:54 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:38:54 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:38:54 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:39:23 | INFO     | api.routes:update_machine_price:43 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:39:23 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:39:23 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 11:39:24 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.44 seconds
2025-04-16 11:39:24 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 1199.0 using JSON-LD
2025-04-16 11:39:24 | INFO     | services.price_service:update_machine_price:85 - Price unchanged for machine 8054eeb8-504f-4791-9f48-a99fe0669664: 1199.0
2025-04-16 11:39:24 | ERROR    | services.database:add_price_history:139 - Error adding price history for machine 8054eeb8-504f-4791-9f48-a99fe0669664: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'new_price' column of 'price_history' in the schema cache"}
2025-04-16 11:41:13 | INFO     | services.database:__init__:19 - Database service initialized
2025-04-16 11:41:13 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:41:13 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:41:13 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:41:35 | INFO     | api.routes:update_machine_price:43 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:41:35 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:41:36 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 11:41:36 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.42 seconds
2025-04-16 11:41:36 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 1199.0 using JSON-LD
2025-04-16 11:41:36 | INFO     | services.price_service:update_machine_price:85 - Price unchanged for machine 8054eeb8-504f-4791-9f48-a99fe0669664: 1199.0
2025-04-16 11:41:36 | INFO     | services.database:add_price_history:155 - Added price history entry for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 11:45:29 | INFO     | api.routes:get_batch_results:168 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | INFO     | services.price_service:get_batch_results:204 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | ERROR    | services.database:get_batch_results:282 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: {'code': '42P01', 'details': None, 'hint': None, 'message': 'relation "public.batch_results" does not exist'}
2025-04-16 11:45:29 | WARNING  | services.price_service:get_batch_results:211 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | WARNING  | api.routes:get_batch_results:175 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | INFO     | api.routes:get_batch_results:168 - Fetching batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | INFO     | services.price_service:get_batch_results:204 - Retrieving batch results for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | ERROR    | services.database:get_batch_results:282 - Error retrieving batch results for batch_id 7aa83653-9fde-423a-83d5-42559502ea80: {'code': '42P01', 'details': None, 'hint': None, 'message': 'relation "public.batch_results" does not exist'}
2025-04-16 11:45:29 | WARNING  | services.price_service:get_batch_results:211 - No batch data found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:45:29 | WARNING  | api.routes:get_batch_results:175 - No batch results found for batch_id: 7aa83653-9fde-423a-83d5-42559502ea80
2025-04-16 11:49:49 | INFO     | services.database:__init__:20 - Database service initialized
2025-04-16 11:49:49 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:49:49 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:49:49 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 11:51:14 | INFO     | services.price_service:batch_update_machines:205 - Starting batch update for machines with threshold of 0 days
2025-04-16 11:51:21 | INFO     | services.database:get_machines_needing_update:220 - Found 150 machines needing price updates
2025-04-16 11:51:21 | ERROR    | services.database:create_batch:294 - Error creating batch: {'code': '42501', 'details': None, 'hint': None, 'message': 'new row violates row-level security policy for table "batches"'}
2025-04-16 11:51:21 | ERROR    | services.price_service:batch_update_machines:224 - Failed to create batch record
2025-04-16 11:54:18 | INFO     | services.database:__init__:20 - Database service initialized
2025-04-16 11:54:18 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 11:54:18 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 11:54:18 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:01:29 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:01:29 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:01:29 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:01:29 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:11:27 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:11:27 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:11:27 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:11:27 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:11:32 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:11:32 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: type object 'datetime.datetime' has no attribute 'datetime'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111a34b80>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104b3f2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104b9c540>
    └ <uvicorn.server.Server object at 0x111a4c110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104b9c5e0>
           │       │   └ <uvicorn.server.Server object at 0x111a4c110>
           │       └ <function run at 0x10438ce00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x111996890>
           │      └ <function Runner.run at 0x1043f4720>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x111a528e0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37610>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x111a3bd10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37610>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37610>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
          └ <fastapi.applications.FastAPI object at 0x111a3bd10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af5440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af5440>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x106795760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x111f36b10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x111ae7250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x111ae7250>>
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1066e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x111af4900>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x111f36a10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5760>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f376...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x111f36a10>
                     └ <function get_request_handler.<locals>.app at 0x111af4a40>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1066e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1119f7420>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x107ccb420>
                     │             └ <services.database.DatabaseService object at 0x106902c90>
                     └ <services.price_service.PriceService object at 0x1069023d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 192, in get_machines_needing_update
    today = datetime.datetime.now()
            └ <class 'datetime.datetime'>

AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
2025-04-16 12:11:48 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:11:48 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: type object 'datetime.datetime' has no attribute 'datetime'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111a34b80>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104b3f2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104b9c540>
    └ <uvicorn.server.Server object at 0x111a4c110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104b9c5e0>
           │       │   └ <uvicorn.server.Server object at 0x111a4c110>
           │       └ <function run at 0x10438ce00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x111996890>
           │      └ <function Runner.run at 0x1043f4720>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x111a528e0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37510>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x111a3bd10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37510>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37510>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
          └ <fastapi.applications.FastAPI object at 0x111a3bd10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af53a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af53a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x106795760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x111f37850>
          │                            │    └ <fastapi.routing.APIRouter object at 0x111ae7250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x111ae7250>>
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1066e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x111af4900>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x111f377d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5760>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f375...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x111f377d0>
                     └ <function get_request_handler.<locals>.app at 0x111af4a40>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1066e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1119f7420>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x107ccb420>
                     │             └ <services.database.DatabaseService object at 0x106902c90>
                     └ <services.price_service.PriceService object at 0x1069023d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 192, in get_machines_needing_update
    today = datetime.datetime.now()
            └ <class 'datetime.datetime'>

AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
2025-04-16 12:11:52 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:11:52 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: object APIResponse[~_ReturnT] can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111a34b80>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104b3f2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104b9c540>
    └ <uvicorn.server.Server object at 0x111a4c110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104b9c5e0>
           │       │   └ <uvicorn.server.Server object at 0x111a4c110>
           │       └ <function run at 0x10438ce00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x111996890>
           │      └ <function Runner.run at 0x1043f4720>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x111a528e0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37790>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x111a3bd10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37790>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f37790>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
          └ <fastapi.applications.FastAPI object at 0x111a3bd10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af53a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af53a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x106795760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x111f36e10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x111ae7250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x111ae7250>>
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1066e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x111af4900>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5580>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x111f367d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af5760>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111f377...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x111af5620>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x111f367d0>
                     └ <function get_request_handler.<locals>.app at 0x111af4a40>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1066e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 0, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1119f7420>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 0
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x107ccb420>
                     │             └ <services.database.DatabaseService object at 0x106902c90>
                     └ <services.price_service.PriceService object at 0x1069023d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 211, in get_machines_needing_update
    response = await query.execute()
                     │     └ <function SyncQueryRequestBuilder.execute at 0x107b90220>
                     └ <postgrest._sync.request_builder.SyncSelectRequestBuilder object at 0x112230ed0>

TypeError: object APIResponse[~_ReturnT] can't be used in 'await' expression
2025-04-16 12:11:52 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:11:53 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: object APIResponse[~_ReturnT] can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111a34b80>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104b3f2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104b9c540>
    └ <uvicorn.server.Server object at 0x111a4c110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104b9c5e0>
           │       │   └ <uvicorn.server.Server object at 0x111a4c110>
           │       └ <function run at 0x10438ce00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x111996890>
           │      └ <function Runner.run at 0x1043f4720>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x111a528e0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111a4c310>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x111a3bd10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111a7fd50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
          └ <fastapi.applications.FastAPI object at 0x111a3bd10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af5580>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x111abe110>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111af5580>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x106795760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111a1a810>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x112232cd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x111ae7250>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111a32290>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af56c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af56c0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x111ae7250>>
          └ <fastapi.routing.APIRouter object at 0x111ae7250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af56c0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1066e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af56c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x111af4900>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111af56c0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x112233c50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111af5760>
          └ <function wrap_app_handling_exceptions at 0x1066e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111fe16c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112231c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x111af5760>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x112233c50>
                     └ <function get_request_handler.<locals>.app at 0x111af4a40>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1066e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 0, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1119f7420>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 0
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x107ccb420>
                     │             └ <services.database.DatabaseService object at 0x106902c90>
                     └ <services.price_service.PriceService object at 0x1069023d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 211, in get_machines_needing_update
    response = await query.execute()
                     │     └ <function SyncQueryRequestBuilder.execute at 0x107b90220>
                     └ <postgrest._sync.request_builder.SyncSelectRequestBuilder object at 0x111f36a50>

TypeError: object APIResponse[~_ReturnT] can't be used in 'await' expression
2025-04-16 12:15:10 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:15:10 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:15:10 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:15:10 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:15:18 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:15:18 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: type object 'datetime.datetime' has no attribute 'timedelta'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x107438ae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x103f4b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103fa8540>
    └ <uvicorn.server.Server object at 0x1074484d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103fa85e0>
           │       │   └ <uvicorn.server.Server object at 0x1074484d0>
           │       └ <function run at 0x103794e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1073967a0>
           │      └ <function Runner.run at 0x103800720>
           └ <asyncio.runners.Runner object at 0x1074485d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x107452810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1074485d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10747fd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f650>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x107448250>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10747fd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f650>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f650>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11891e210>
          └ <fastapi.applications.FastAPI object at 0x107448250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1074f93a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11891e210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1074f93a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x105395760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10741fc50>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x11891eb50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1074e7290>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10741fc50>
          └ <function wrap_app_handling_exceptions at 0x1052e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1074e7290>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1074e7290>>
          └ <fastapi.routing.APIRouter object at 0x1074e7290>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1052e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1074f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x11891ef90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1074f9580>
          └ <function wrap_app_handling_exceptions at 0x1052e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11891f6...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1074f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x11891ef90>
                     └ <function get_request_handler.<locals>.app at 0x1074f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1052e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1073f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1067cf380>
                     │             └ <services.database.DatabaseService object at 0x105403d50>
                     └ <services.price_service.PriceService object at 0x105403c90>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 195, in get_machines_needing_update
    threshold_date = today - datetime.timedelta(days=days_threshold)
                     │       │                       └ 7
                     │       └ <class 'datetime.datetime'>
                     └ datetime.datetime(2025, 4, 16, 12, 15, 18, 193218)

AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
2025-04-16 12:15:39 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:15:39 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: type object 'datetime.datetime' has no attribute 'timedelta'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x107438ae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x103f4b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103fa8540>
    └ <uvicorn.server.Server object at 0x1074484d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103fa85e0>
           │       │   └ <uvicorn.server.Server object at 0x1074484d0>
           │       └ <function run at 0x103794e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1073967a0>
           │      └ <function Runner.run at 0x103800720>
           └ <asyncio.runners.Runner object at 0x1074485d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x107452810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1074485d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10747fd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x118928610>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x107448250>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10747fd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x118928610>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x118928610>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11891e210>
          └ <fastapi.applications.FastAPI object at 0x107448250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1074f9440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11891e210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1074f9440>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x105395760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10741fc50>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x10742f210>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x11891f690>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1074e7290>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10741fc50>
          └ <function wrap_app_handling_exceptions at 0x1052e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1074e7290>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1074e7290>>
          └ <fastapi.routing.APIRouter object at 0x1074e7290>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1052e1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1074f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x11891f810>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1074f9580>
          └ <function wrap_app_handling_exceptions at 0x1052e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1074f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1189286...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1074f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x11891f810>
                     └ <function get_request_handler.<locals>.app at 0x1074f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1052e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1073f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1067cf380>
                     │             └ <services.database.DatabaseService object at 0x105403d50>
                     └ <services.price_service.PriceService object at 0x105403c90>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 195, in get_machines_needing_update
    threshold_date = today - datetime.timedelta(days=days_threshold)
                     │       │                       └ 7
                     │       └ <class 'datetime.datetime'>
                     └ datetime.datetime(2025, 4, 16, 12, 15, 39, 14076)

AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
2025-04-16 12:15:48 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6
2025-04-16 12:15:48 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6
2025-04-16 12:15:48 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://store.creality.com/products/falcon2-22w-laser-engraver-cutter
2025-04-16 12:15:50 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://store.creality.com/products/falcon2-22w-laser-engraver-cutter in 1.96 seconds
2025-04-16 12:15:50 | INFO     | scrapers.price_extractor:_extract_from_structured_data:91 - Extracted price 719.0 using JSON-LD offers array
2025-04-16 12:15:50 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6: 719.0
2025-04-16 12:15:51 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6
2025-04-16 12:17:42 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:17:42 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:17:42 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:17:42 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:17:45 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:17:45 | ERROR    | services.database:get_machines_needing_update:227 - Error in get_machines_needing_update: {'code': 'PGRST108', 'details': None, 'hint': "Verify that 'html_timestamp' is included in the 'select' query parameter.", 'message': "'html_timestamp' is not an embedded resource in this request"}
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x110d34ae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10590b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x105968540>
    └ <uvicorn.server.Server object at 0x110d4c290>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1059685e0>
           │       │   └ <uvicorn.server.Server object at 0x110d4c290>
           │       └ <function run at 0x105154e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x110c967a0>
           │      └ <function Runner.run at 0x1051c0720>
           └ <asyncio.runners.Runner object at 0x110d09610>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x110d52810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x110d09610>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x110d7fad0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111003410>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x110de6a10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x110d7fad0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111003410>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x111003410>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x110d2d150>
          └ <fastapi.applications.FastAPI object at 0x110de6a10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110df93a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x110712050>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x110d2d150>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110df93a0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x106c95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x110712050>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x110712050>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x110d27cd0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x110712050>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x110712050>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x111002750>
          │                            │    └ <fastapi.routing.APIRouter object at 0x110de6fd0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x110d27cd0>
          └ <function wrap_app_handling_exceptions at 0x106ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x110de6fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x110de6fd0>>
          └ <fastapi.routing.APIRouter object at 0x110de6fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106ae1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x110df8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1110033d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x110df9580>
          └ <function wrap_app_handling_exceptions at 0x106ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x110df96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110034...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x110df9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1110033d0>
                     └ <function get_request_handler.<locals>.app at 0x110df89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106ae18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x110cf7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1100cf380>
                     │             └ <services.database.DatabaseService object at 0x106d03b10>
                     └ <services.price_service.PriceService object at 0x106d03bd0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 211, in get_machines_needing_update
    response = query.execute()
               │     └ <function SyncQueryRequestBuilder.execute at 0x107e8c180>
               └ <postgrest._sync.request_builder.SyncSelectRequestBuilder object at 0x11100c550>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", line 78, in execute
    raise APIError(r.json())
          │        │ └ <function Response.json at 0x1071bb600>
          │        └ <Response [400 Bad Request]>
          └ <class 'postgrest.exceptions.APIError'>

postgrest.exceptions.APIError: {'code': 'PGRST108', 'details': None, 'hint': "Verify that 'html_timestamp' is included in the 'select' query parameter.", 'message': "'html_timestamp' is not an embedded resource in this request"}
2025-04-16 12:20:21 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:20:21 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:20:21 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:20:21 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:20:38 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:20:38 | ERROR    | services.database:get_machines_needing_update:267 - Error in get_machines_needing_update: 'APIResponse[~_ReturnT]' object has no attribute 'error'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x11113cae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10386b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103a00540>
    └ <uvicorn.server.Server object at 0x1038619d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103a005e0>
           │       │   └ <uvicorn.server.Server object at 0x1038619d0>
           │       └ <function run at 0x1030b4e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1110967a0>
           │      └ <function Runner.run at 0x103120720>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11112e9b0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1111e6d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
          └ <fastapi.applications.FastAPI object at 0x1111e6d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x11113e200>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x11113e200>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x104c95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x112436dd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1111e72d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1111e72d0>>
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ae1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1111f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x112436e10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437a...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x112436e10>
                     └ <function get_request_handler.<locals>.app at 0x1111f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ae18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1110f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1072cf380>
                     │             └ <services.database.DatabaseService object at 0x104ec78d0>
                     └ <services.price_service.PriceService object at 0x104ec7950>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 217, in get_machines_needing_update
    if response1.error:
       └ APIResponse[~_ReturnT](data=[], count=None)

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'APIResponse[~_ReturnT]' object has no attribute 'error'
2025-04-16 12:21:04 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:21:05 | ERROR    | services.database:get_machines_needing_update:267 - Error in get_machines_needing_update: 'APIResponse[~_ReturnT]' object has no attribute 'error'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x11113cae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10386b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103a00540>
    └ <uvicorn.server.Server object at 0x1038619d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103a005e0>
           │       │   └ <uvicorn.server.Server object at 0x1038619d0>
           │       └ <function run at 0x1030b4e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1110967a0>
           │      └ <function Runner.run at 0x103120720>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11112e9b0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1111e6d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
          └ <fastapi.applications.FastAPI object at 0x1111e6d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1111f9440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1111f9440>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x104c95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x11111e050>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1111e72d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1111e72d0>>
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ae1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1111f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x11111ee90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437c...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x11111ee90>
                     └ <function get_request_handler.<locals>.app at 0x1111f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ae18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 7, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1110f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 7
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1072cf380>
                     │             └ <services.database.DatabaseService object at 0x104ec78d0>
                     └ <services.price_service.PriceService object at 0x104ec7950>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 217, in get_machines_needing_update
    if response1.error:
       └ APIResponse[~_ReturnT](data=[], count=None)

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'APIResponse[~_ReturnT]' object has no attribute 'error'
2025-04-16 12:21:08 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:21:08 | ERROR    | services.database:get_machines_needing_update:267 - Error in get_machines_needing_update: 'APIResponse[~_ReturnT]' object has no attribute 'error'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x11113cae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10386b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103a00540>
    └ <uvicorn.server.Server object at 0x1038619d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103a005e0>
           │       │   └ <uvicorn.server.Server object at 0x1038619d0>
           │       └ <function run at 0x1030b4e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1110967a0>
           │      └ <function Runner.run at 0x103120720>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11112e9b0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1111e6d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
          └ <fastapi.applications.FastAPI object at 0x1111e6d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1111f9440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1111f9440>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x104c95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x112436dd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1111e72d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1111e72d0>>
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ae1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1111f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x112437a50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1110fb2...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x112437a50>
                     └ <function get_request_handler.<locals>.app at 0x1111f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ae18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 0, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1110f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 0
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1072cf380>
                     │             └ <services.database.DatabaseService object at 0x104ec78d0>
                     └ <services.price_service.PriceService object at 0x104ec7950>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 253, in get_machines_needing_update
    if response.error:
       └ APIResponse[~_ReturnT](data=[{'id': 'c23808f6-1760-4cad-b031-3c5eb3556d98', 'Machine Name': 'AlgoLaser Delta 40W Laser', 'Com...

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'APIResponse[~_ReturnT]' object has no attribute 'error'
2025-04-16 12:21:08 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:21:08 | ERROR    | services.database:get_machines_needing_update:267 - Error in get_machines_needing_update: 'APIResponse[~_ReturnT]' object has no attribute 'error'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x11113cae0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x10386b2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x103a00540>
    └ <uvicorn.server.Server object at 0x1038619d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x103a005e0>
           │       │   └ <uvicorn.server.Server object at 0x1038619d0>
           │       └ <function run at 0x1030b4e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1110967a0>
           │      └ <function Runner.run at 0x103120720>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11112e9b0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x11114c6d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1111e6d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11117fdd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
          └ <fastapi.applications.FastAPI object at 0x1111e6d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x11113e200>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1111306d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '31', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x11113e200>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x104c95760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x111130250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x111130250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x112436b50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1111e72d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x111125ed0>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1111e72d0>>
          └ <fastapi.routing.APIRouter object at 0x1111e72d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ae1da0>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1111f8860>
          └ APIRoute(path='/api/v1/batch-configure', name='configure_batch_update', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f94e0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x112437b10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
          └ <function wrap_app_handling_exceptions at 0x104ae07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1111f96c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x112437d...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1111f9580>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x112437b10>
                     └ <function get_request_handler.<locals>.app at 0x1111f89a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ae18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': {'days_threshold': 0, 'limit': 10}}
                 │         └ <function configure_batch_update at 0x1110f7380>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 227, in configure_batch_update
    machines = await price_service.db_service.get_machines_needing_update(days_threshold)
                     │             │          │                           └ 0
                     │             │          └ <function DatabaseService.get_machines_needing_update at 0x1072cf380>
                     │             └ <services.database.DatabaseService object at 0x104ec78d0>
                     └ <services.price_service.PriceService object at 0x104ec7950>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 253, in get_machines_needing_update
    if response.error:
       └ APIResponse[~_ReturnT](data=[{'id': 'c23808f6-1760-4cad-b031-3c5eb3556d98', 'Machine Name': 'AlgoLaser Delta 40W Laser', 'Com...

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/pydantic/main.py", line 994, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'APIResponse[~_ReturnT]' object has no attribute 'error'
2025-04-16 12:22:52 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:22:52 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:22:52 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:22:52 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:22:55 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:22:56 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:23:02 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:23:02 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:23:05 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:23:05 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:23:08 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:23:08 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:08 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:23:08 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:12 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=100
2025-04-16 12:23:12 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:12 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=100
2025-04-16 12:23:12 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:14 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:23:15 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:15 | INFO     | api.routes:configure_batch_update:224 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:23:15 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:23:18 | INFO     | services.price_service:batch_update_machines:208 - Starting batch update for machines with threshold of 7 days and limit of none
2025-04-16 12:23:19 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:23:19 | INFO     | services.price_service:batch_update_machines:214 - No machines need price updates at this time
2025-04-16 12:26:27 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:26:27 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:26:27 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:26:27 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:26:35 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:26:35 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:26:37 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:26:38 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:26:41 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:26:41 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:26:42 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:26:42 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:26:49 | INFO     | api.routes:batch_update_machines:115 - Batch update request with days=0, limit=10, machine_ids=['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e4093bf6-7a1c-4325-9094-8c572a307459', 'b2956e47-a9da-4359-8c88-42ca9a8740e7']
2025-04-16 12:26:49 | INFO     | services.price_service:batch_update_machines:210 - Starting batch update with days_threshold=0, limit=10, machine_ids=10
2025-04-16 12:26:49 | INFO     | services.price_service:batch_update_machines:214 - Using 10 provided machine IDs for batch update
2025-04-16 12:26:49 | INFO     | services.database:get_machines_needing_update:252 - Found 10 machines for price update
2025-04-16 12:26:49 | INFO     | services.price_service:batch_update_machines:225 - Starting batch update for 10 machines
2025-04-16 12:26:49 | ERROR    | services.database:create_batch:327 - Error creating batch: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'completed_at' column of 'batches' in the schema cache"}
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x110030b80>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x1041cb2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104228540>
    └ <uvicorn.server.Server object at 0x110037ad0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x1042285e0>
           │       │   └ <uvicorn.server.Server object at 0x110037ad0>
           │       └ <function run at 0x103a14e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x107ef25c0>
           │      └ <function Runner.run at 0x103a80720>
           └ <asyncio.runners.Runner object at 0x110037bd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11004e8e0>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x110037bd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11007b750>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c650>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1100e2790>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x11007b750>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c650>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c650>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1100e3410>
          └ <fastapi.applications.FastAPI object at 0x1100e2790>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1100f9260>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1100e3950>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1100e3410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '437', 'sec-ch-ua-platform': '"macOS"', 'use...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1100f9260>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x1050f5760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1100e3950>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1100e3950>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10753c290>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1100e3950>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1100e3950>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x11030cbd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1100e2d50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x10753c290>
          └ <function wrap_app_handling_exceptions at 0x1050407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9440>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1100e2d50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9440>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1100e2d50>>
          └ <fastapi.routing.APIRouter object at 0x1100e2d50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9440>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105041da0>
          └ APIRoute(path='/api/v1/batch-update', name='batch_update_machines', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1100f82c0>
          └ APIRoute(path='/api/v1/batch-update', name='batch_update_machines', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9440>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x11030ccd0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1100f94e0>
          └ <function wrap_app_handling_exceptions at 0x1050407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9620>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1100f94e0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    await response(scope, receive, send)
          │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1100f9620>
          │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x11030c6...
          │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <starlette.responses.JSONResponse object at 0x11030d810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/responses.py", line 159, in __call__
    await self.background()
          │    └ <fastapi.background.BackgroundTasks object at 0x11030fb10>
          └ <starlette.responses.JSONResponse object at 0x11030d810>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/background.py", line 41, in __call__
    await task()
          └ <starlette.background.BackgroundTask object at 0x11030e5d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/background.py", line 26, in __call__
    await self.func(*self.args, **self.kwargs)
          │    │     │    │       │    └ {}
          │    │     │    │       └ <starlette.background.BackgroundTask object at 0x11030e5d0>
          │    │     │    └ (0, 10, ['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68...
          │    │     └ <starlette.background.BackgroundTask object at 0x11030e5d0>
          │    └ <function _process_batch_update at 0x107f56ac0>
          └ <starlette.background.BackgroundTask object at 0x11030e5d0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 218, in _process_batch_update
    await price_service.batch_update_machines(days_threshold, limit=limit, machine_ids=machine_ids)
          │             │                     │                     │                  └ ['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e40...
          │             │                     │                     └ 10
          │             │                     └ 0
          │             └ <function PriceService.batch_update_machines at 0x107f55b20>
          └ <services.price_service.PriceService object at 0x105226ed0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/price_service.py", line 228, in batch_update_machines
    batch_id = await self.db_service.create_batch(
                     │    │          └ <function DatabaseService.create_batch at 0x106bdb4c0>
                     │    └ <services.database.DatabaseService object at 0x105226c90>
                     └ <services.price_service.PriceService object at 0x105226ed0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 318, in create_batch
    }).execute()

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/postgrest/_sync/request_builder.py", line 78, in execute
    raise APIError(r.json())
          │        │ └ <function Response.json at 0x1056db600>
          │        └ <Response [400 Bad Request]>
          └ <class 'postgrest.exceptions.APIError'>

postgrest.exceptions.APIError: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'completed_at' column of 'batches' in the schema cache"}
2025-04-16 12:26:49 | ERROR    | services.price_service:batch_update_machines:237 - Failed to create batch record
2025-04-16 12:31:50 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:31:50 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:31:50 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:31:50 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:31:54 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:31:55 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:31:56 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:31:56 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:31:59 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:31:59 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:31:59 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:31:59 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:32:01 | INFO     | api.routes:batch_update_machines:115 - Batch update request with days=0, limit=10, machine_ids=['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e4093bf6-7a1c-4325-9094-8c572a307459', 'b2956e47-a9da-4359-8c88-42ca9a8740e7']
2025-04-16 12:32:01 | INFO     | services.price_service:batch_update_machines:210 - Starting batch update with days_threshold=0, limit=10, machine_ids=10
2025-04-16 12:32:01 | INFO     | services.price_service:batch_update_machines:214 - Using 10 provided machine IDs for batch update
2025-04-16 12:32:01 | INFO     | services.database:get_machines_needing_update:252 - Found 10 machines for price update
2025-04-16 12:32:01 | INFO     | services.price_service:batch_update_machines:225 - Starting batch update for 10 machines
2025-04-16 12:32:02 | INFO     | services.database:create_batch:322 - Created batch record with ID b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 12:32:02 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 12:32:02 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-04-16 12:32:02 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742 in 0.83 seconds
2025-04-16 12:32:03 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 169.0 using JSON-LD
2025-04-16 12:32:03 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c: 169.0
2025-04-16 12:32:03 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 12:32:03 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:03 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 12:32:03 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 12:32:03 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.53 seconds
2025-04-16 12:32:03 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 6995.0 using JSON-LD
2025-04-16 12:32:03 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836: 6995.0
2025-04-16 12:32:04 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 12:32:04 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:04 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 12:32:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area
2025-04-16 12:32:05 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area in 0.85 seconds
2025-04-16 12:32:05 | INFO     | scrapers.price_extractor:_extract_from_common_selectors:157 - Extracted price 259900.0 using selector '[data-price]'
2025-04-16 12:32:05 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403: 259900.0
2025-04-16 12:32:05 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 12:32:05 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:05 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 12:32:05 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-04-16 12:32:06 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum in 0.91 seconds
2025-04-16 12:32:06 | INFO     | scrapers.price_extractor:_extract_from_structured_data:91 - Extracted price 2199.99 using JSON-LD offers array
2025-04-16 12:32:06 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine b2956e47-a9da-4359-8c88-42ca9a8740e7: 2199.99
2025-04-16 12:32:07 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 12:32:07 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine b2956e47-a9da-4359-8c88-42ca9a8740e7: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:07 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 12:32:07 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 12:32:08 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.61 seconds
2025-04-16 12:32:08 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 1299.0 using JSON-LD
2025-04-16 12:32:08 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine c23808f6-1760-4cad-b031-3c5eb3556d98: 1299.0
2025-04-16 12:32:08 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 12:32:08 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine c23808f6-1760-4cad-b031-3c5eb3556d98: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:08 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 12:32:08 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/nova-s
2025-04-16 12:32:08 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/nova-s in 0.06 seconds
2025-04-16 12:32:08 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 17995.0 using JSON-LD
2025-04-16 12:32:08 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f: 17995.0
2025-04-16 12:32:08 | INFO     | services.database:add_price_history:159 - Added price history entry for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 12:32:09 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:09 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 12:32:09 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-04-16 12:32:10 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739 in 1.18 seconds
2025-04-16 12:32:10 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 339.0 using JSON-LD
2025-04-16 12:32:10 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine e4093bf6-7a1c-4325-9094-8c572a307459: 339.0
2025-04-16 12:32:10 | INFO     | services.database:add_price_history:159 - Added price history entry for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 12:32:11 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine e4093bf6-7a1c-4325-9094-8c572a307459: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:11 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 12:32:11 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/supernova-s
2025-04-16 12:32:11 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/supernova-s in 0.09 seconds
2025-04-16 12:32:11 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 25495.0 using JSON-LD
2025-04-16 12:32:11 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine ef4f7a07-a068-4afc-b550-22d101c6e68b: 25495.0
2025-04-16 12:32:11 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 12:32:11 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine ef4f7a07-a068-4afc-b550-22d101c6e68b: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:11 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 12:32:11 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 12:32:12 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser in 0.53 seconds
2025-04-16 12:32:12 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 649.0 using JSON-LD
2025-04-16 12:32:12 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16: 649.0
2025-04-16 12:32:12 | INFO     | services.database:add_price_history:159 - Added price history entry for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 12:32:12 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:12 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 12:32:12 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 12:32:13 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.06 seconds
2025-04-16 12:32:13 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 6995.0 using JSON-LD
2025-04-16 12:32:13 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5: 6995.0
2025-04-16 12:32:13 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 12:32:13 | ERROR    | services.database:add_batch_result:427 - Error adding batch result for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'created_at' column of 'batch_results' in the schema cache"}
2025-04-16 12:32:13 | INFO     | services.database:complete_batch:353 - Marked batch b3cc1c8c-7375-4d37-b16d-8040a807c969 as completed
2025-04-16 12:32:13 | INFO     | services.price_service:batch_update_machines:274 - Batch update completed. Results: 10 successful, 0 failed
2025-04-16 12:34:27 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:34:27 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:34:27 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:34:27 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:34:32 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:34:32 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:34:34 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:34:35 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:34:37 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:34:38 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:34:38 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:34:38 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:34:38 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 12:34:38 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 12:34:40 | INFO     | api.routes:batch_update_machines:115 - Batch update request with days=0, limit=10, machine_ids=['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e4093bf6-7a1c-4325-9094-8c572a307459', 'b2956e47-a9da-4359-8c88-42ca9a8740e7']
2025-04-16 12:34:40 | INFO     | services.price_service:batch_update_machines:210 - Starting batch update with days_threshold=0, limit=10, machine_ids=10
2025-04-16 12:34:40 | INFO     | services.price_service:batch_update_machines:214 - Using 10 provided machine IDs for batch update
2025-04-16 12:34:40 | INFO     | services.database:get_machines_needing_update:252 - Found 10 machines for price update
2025-04-16 12:34:40 | INFO     | services.price_service:batch_update_machines:225 - Starting batch update for 10 machines
2025-04-16 12:34:40 | INFO     | services.database:create_batch:322 - Created batch record with ID 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:40 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 12:34:41 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-04-16 12:34:41 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742 in 0.76 seconds
2025-04-16 12:34:41 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 169.0 using JSON-LD
2025-04-16 12:34:41 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c: 169.0
2025-04-16 12:34:41 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 12:34:42 | INFO     | services.database:add_batch_result:424 - Added result for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:42 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 12:34:42 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 12:34:42 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.20 seconds
2025-04-16 12:34:42 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 6995.0 using JSON-LD
2025-04-16 12:34:42 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836: 6995.0
2025-04-16 12:34:42 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 12:34:42 | INFO     | services.database:add_batch_result:424 - Added result for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:42 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 12:34:43 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area
2025-04-16 12:34:43 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area in 0.57 seconds
2025-04-16 12:34:43 | INFO     | scrapers.price_extractor:_extract_from_common_selectors:157 - Extracted price 259900.0 using selector '[data-price]'
2025-04-16 12:34:43 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403: 259900.0
2025-04-16 12:34:43 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 12:34:44 | INFO     | services.database:add_batch_result:424 - Added result for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:44 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 12:34:44 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-04-16 12:34:44 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum in 0.17 seconds
2025-04-16 12:34:44 | INFO     | scrapers.price_extractor:_extract_from_structured_data:91 - Extracted price 2199.99 using JSON-LD offers array
2025-04-16 12:34:44 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine b2956e47-a9da-4359-8c88-42ca9a8740e7: 2199.99
2025-04-16 12:34:44 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 12:34:45 | INFO     | services.database:add_batch_result:424 - Added result for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:45 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 12:34:45 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 12:34:45 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.17 seconds
2025-04-16 12:34:45 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 1299.0 using JSON-LD
2025-04-16 12:34:45 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine c23808f6-1760-4cad-b031-3c5eb3556d98: 1299.0
2025-04-16 12:34:45 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 12:34:46 | INFO     | services.database:add_batch_result:424 - Added result for machine c23808f6-1760-4cad-b031-3c5eb3556d98 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:46 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 12:34:46 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/nova-s
2025-04-16 12:34:46 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/nova-s in 0.06 seconds
2025-04-16 12:34:46 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 17995.0 using JSON-LD
2025-04-16 12:34:46 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f: 17995.0
2025-04-16 12:34:46 | INFO     | services.database:add_price_history:159 - Added price history entry for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 12:34:46 | INFO     | services.database:add_batch_result:424 - Added result for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:46 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 12:34:47 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-04-16 12:34:47 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739 in 0.15 seconds
2025-04-16 12:34:47 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 339.0 using JSON-LD
2025-04-16 12:34:47 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine e4093bf6-7a1c-4325-9094-8c572a307459: 339.0
2025-04-16 12:34:47 | INFO     | services.database:add_price_history:159 - Added price history entry for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 12:34:47 | INFO     | services.database:add_batch_result:424 - Added result for machine e4093bf6-7a1c-4325-9094-8c572a307459 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:47 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 12:34:47 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/supernova-s
2025-04-16 12:34:47 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/supernova-s in 0.11 seconds
2025-04-16 12:34:47 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 25495.0 using JSON-LD
2025-04-16 12:34:47 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine ef4f7a07-a068-4afc-b550-22d101c6e68b: 25495.0
2025-04-16 12:34:48 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 12:34:48 | INFO     | services.database:add_batch_result:424 - Added result for machine ef4f7a07-a068-4afc-b550-22d101c6e68b to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:48 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 12:34:48 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 12:34:49 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser in 0.82 seconds
2025-04-16 12:34:49 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 649.0 using JSON-LD
2025-04-16 12:34:49 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16: 649.0
2025-04-16 12:34:49 | INFO     | services.database:add_price_history:159 - Added price history entry for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 12:34:49 | INFO     | services.database:add_batch_result:424 - Added result for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:49 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 12:34:50 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 12:34:50 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.06 seconds
2025-04-16 12:34:50 | INFO     | scrapers.price_extractor:_extract_from_structured_data:82 - Extracted price 6995.0 using JSON-LD
2025-04-16 12:34:50 | INFO     | services.price_service:update_machine_price:116 - Price unchanged for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5: 6995.0
2025-04-16 12:34:50 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 12:34:50 | INFO     | services.database:add_batch_result:424 - Added result for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5 to batch 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:34:50 | INFO     | services.database:complete_batch:353 - Marked batch 1fcd5523-b602-40ec-a4fd-19a177a5721c as completed
2025-04-16 12:34:50 | INFO     | services.price_service:batch_update_machines:274 - Batch update completed. Results: 10 successful, 0 failed
2025-04-16 12:40:21 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:40:22 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:40:29 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:40:29 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:40:47 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:40:47 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:40:47 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:40:47 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:40:57 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:40:58 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:40:58 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 12:40:58 | ERROR    | api.routes:get_batches:308 - Error fetching batch jobs: object APIResponse[~_ReturnT] can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x108321080>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x1059cb2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x105a28540>
    └ <uvicorn.server.Server object at 0x1083313d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x105a285e0>
           │       │   └ <uvicorn.server.Server object at 0x1083313d0>
           │       └ <function run at 0x105214e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10827a6b0>
           │      └ <function Runner.run at 0x105280720>
           └ <asyncio.runners.Runner object at 0x108313090>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x10833e810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x108313090>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108374ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a6310>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x107e07d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108374ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a6310>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a6310>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10831a1d0>
          └ <fastapi.applications.FastAPI object at 0x107e07d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1083e5b20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10831a1d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"macOS"', 'user-agent': 'Mozilla/5.0 (M...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1083e5b20>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x1068f5760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x108310250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1083331d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x108310250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x107e2cc10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1083e0550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1083331d0>
          └ <function wrap_app_handling_exceptions at 0x1068407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1083e0550>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1083e0550>>
          └ <fastapi.routing.APIRouter object at 0x1083e0550>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106841da0>
          └ APIRoute(path='/api/v1/batches', name='get_batches', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1083e4f40>
          └ APIRoute(path='/api/v1/batches', name='get_batches', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1082f4b50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1083e5d00>
          └ <function wrap_app_handling_exceptions at 0x1068407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e65c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1084a63...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1083e5d00>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1082f4b50>
                     └ <function get_request_handler.<locals>.app at 0x1083e4ea0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1068418a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function get_batches at 0x1082e76a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 284, in get_batches
    response = await price_service.db_service.supabase.table("batches") \
                     │             │          │        └ <function SyncClient.table at 0x107abe7a0>
                     │             │          └ <supabase._sync.client.SyncClient object at 0x106a275d0>
                     │             └ <services.database.DatabaseService object at 0x106a27650>
                     └ <services.price_service.PriceService object at 0x106a27590>

TypeError: object APIResponse[~_ReturnT] can't be used in 'await' expression
2025-04-16 12:44:21 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:44:21 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:44:21 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 12:44:21 | ERROR    | api.routes:get_batches:308 - Error fetching batch jobs: object APIResponse[~_ReturnT] can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x108321080>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x1059cb2e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x105a28540>
    └ <uvicorn.server.Server object at 0x1083313d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x105a285e0>
           │       │   └ <uvicorn.server.Server object at 0x1083313d0>
           │       └ <function run at 0x105214e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10827a6b0>
           │      └ <function Runner.run at 0x105280720>
           └ <asyncio.runners.Runner object at 0x108313090>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x10833e810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x108313090>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108374ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x107e07d10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x108374ed0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10831a1d0>
          └ <fastapi.applications.FastAPI object at 0x107e07d10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1083e68e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x10831a1d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"macOS"', 'user-agent': 'Mozilla/5.0 (M...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1083e68e0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x1068f5760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x108310250>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1083331d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x108310250>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x108310250>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1084b3e50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1083e0550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1083331d0>
          └ <function wrap_app_handling_exceptions at 0x1068407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1083e0550>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1083e0550>>
          └ <fastapi.routing.APIRouter object at 0x1083e0550>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106841da0>
          └ APIRoute(path='/api/v1/batches', name='get_batches', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1083e4f40>
          └ APIRoute(path='/api/v1/batches', name='get_batches', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e5c60>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1084b3610>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1083e5d00>
          └ <function wrap_app_handling_exceptions at 0x1068407c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1083e6480>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1085bfc...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1083e5d00>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1084b3610>
                     └ <function get_request_handler.<locals>.app at 0x1083e4ea0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1068418a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function get_batches at 0x1082e76a0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], security_requ...

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 284, in get_batches
    response = await price_service.db_service.supabase.table("batches") \
                     │             │          │        └ <function SyncClient.table at 0x107abe7a0>
                     │             │          └ <supabase._sync.client.SyncClient object at 0x106a275d0>
                     │             └ <services.database.DatabaseService object at 0x106a27650>
                     └ <services.price_service.PriceService object at 0x106a27590>

TypeError: object APIResponse[~_ReturnT] can't be used in 'await' expression
2025-04-16 12:44:36 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:44:36 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:44:36 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:44:36 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:44:43 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 12:44:44 | INFO     | api.routes:get_batches:298 - Found 2 batch jobs
2025-04-16 12:44:44 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '1fcd5523-b602-40ec-a4fd-19a177a5721c', 'status': 'completed', 'start_time': '2025-04-16T12:34:40.860273+00:00', 'end_time': '2025-04-16T12:34:50.497817+00:00', 'total_machines': 10, 'days_threshold': 0}
2025-04-16 12:44:44 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 12:44:44 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 12:44:56 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:44:56 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:44:56 | ERROR    | services.database:get_batch_stats:571 - Error getting batch stats for batch 1fcd5523-b602-40ec-a4fd-19a177a5721c: 'SyncSelectRequestBuilder' object has no attribute 'group'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111031080>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104ca32e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104e00540>
    └ <uvicorn.server.Server object at 0x11035bf90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104e005e0>
           │       │   └ <uvicorn.server.Server object at 0x11035bf90>
           │       └ <function run at 0x104388e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x110f8a6b0>
           │      └ <function Runner.run at 0x1043f0720>
           └ <asyncio.runners.Runner object at 0x111044fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11104e810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111044fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111084fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a5350>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1110cffd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111084fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a5350>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a5350>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11101ab90>
          └ <fastapi.applications.FastAPI object at 0x1110cffd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1110f59e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11101ab90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"macOS"', 'user-agent': 'Mozilla/5.0 (M...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1110f59e0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x107195760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11101bc10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1123a4dd0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1110f05d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11101bc10>
          └ <function wrap_app_handling_exceptions at 0x1070e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5940>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1110f05d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5940>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1110f05d0>>
          └ <fastapi.routing.APIRouter object at 0x1110f05d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5940>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1070e1da0>
          └ APIRoute(path='/api/v1/batch-results/{batch_id}', name='get_batch_results', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1110f4b80>
          └ APIRoute(path='/api/v1/batch-results/{batch_id}', name='get_batch_results', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5940>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1123a5590>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1110f5b20>
          └ <function wrap_app_handling_exceptions at 0x1070e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123a53...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1110f5b20>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1123a5590>
                     └ <function get_request_handler.<locals>.app at 0x1110f4c20>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1070e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'batch_id': '1fcd5523-b602-40ec-a4fd-19a177a5721c'}
                 │         └ <function get_batch_results at 0x110ff6020>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='batch_id', mode='validation')], query_params=[], ...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 195, in get_batch_results
    batch_data = await price_service.get_batch_results(batch_id)
                       │             │                 └ '1fcd5523-b602-40ec-a4fd-19a177a5721c'
                       │             └ <function PriceService.get_batch_results at 0x110ff5c60>
                       └ <services.price_service.PriceService object at 0x1072038d0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/price_service.py", line 304, in get_batch_results
    stats = await self.db_service.get_batch_stats(batch_id)
                  │    │          │               └ '1fcd5523-b602-40ec-a4fd-19a177a5721c'
                  │    │          └ <function DatabaseService.get_batch_stats at 0x1104cf740>
                  │    └ <services.database.DatabaseService object at 0x107203990>
                  └ <services.price_service.PriceService object at 0x1072038d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 518, in get_batch_stats
    .group("success") \

AttributeError: 'SyncSelectRequestBuilder' object has no attribute 'group'
2025-04-16 12:44:56 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:44:56 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:44:56 | ERROR    | services.database:get_batch_stats:571 - Error getting batch stats for batch 1fcd5523-b602-40ec-a4fd-19a177a5721c: 'SyncSelectRequestBuilder' object has no attribute 'group'
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x111031080>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x104ca32e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x104e00540>
    └ <uvicorn.server.Server object at 0x11035bf90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x104e005e0>
           │       │   └ <uvicorn.server.Server object at 0x11035bf90>
           │       └ <function run at 0x104388e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x110f8a6b0>
           │      └ <function Runner.run at 0x1043f0720>
           └ <asyncio.runners.Runner object at 0x111044fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x11104e810>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111044fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111084fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c2610>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1110cffd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x111084fd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c2610>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c2610>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11101ab90>
          └ <fastapi.applications.FastAPI object at 0x1110cffd0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1110f5b20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x11101ab90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'sec-ch-ua-platform': '"macOS"', 'user-agent': 'Mozilla/5.0 (M...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1110f5b20>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x107195760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11101bc10>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x11101bd90>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x1123c2290>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1110f05d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x11101bc10>
          └ <function wrap_app_handling_exceptions at 0x1070e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1110f05d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1110f05d0>>
          └ <fastapi.routing.APIRouter object at 0x1110f05d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1070e1da0>
          └ APIRoute(path='/api/v1/batch-results/{batch_id}', name='get_batch_results', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1110f4b80>
          └ APIRoute(path='/api/v1/batch-results/{batch_id}', name='get_batch_results', methods=['GET'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1110f5d00>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x1123c38d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1110f6a20>
          └ <function wrap_app_handling_exceptions at 0x1070e07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11245a7a0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1123c26...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1110f6a20>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x1123c38d0>
                     └ <function get_request_handler.<locals>.app at 0x1110f4c20>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1070e18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'batch_id': '1fcd5523-b602-40ec-a4fd-19a177a5721c'}
                 │         └ <function get_batch_results at 0x110ff6020>
                 └ Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='batch_id', mode='validation')], query_params=[], ...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 195, in get_batch_results
    batch_data = await price_service.get_batch_results(batch_id)
                       │             │                 └ '1fcd5523-b602-40ec-a4fd-19a177a5721c'
                       │             └ <function PriceService.get_batch_results at 0x110ff5c60>
                       └ <services.price_service.PriceService object at 0x1072038d0>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/price_service.py", line 304, in get_batch_results
    stats = await self.db_service.get_batch_stats(batch_id)
                  │    │          │               └ '1fcd5523-b602-40ec-a4fd-19a177a5721c'
                  │    │          └ <function DatabaseService.get_batch_stats at 0x1104cf740>
                  │    └ <services.database.DatabaseService object at 0x107203990>
                  └ <services.price_service.PriceService object at 0x1072038d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/database.py", line 518, in get_batch_stats
    .group("success") \

AttributeError: 'SyncSelectRequestBuilder' object has no attribute 'group'
2025-04-16 12:48:39 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 12:48:39 | INFO     | scrapers.price_extractor:__init__:16 - Price extractor initialized
2025-04-16 12:48:39 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 12:48:39 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 12:48:50 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:48:50 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:48:51 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 12:48:51 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 15:29:50 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 15:29:50 | INFO     | api.routes:get_batches:298 - Found 2 batch jobs
2025-04-16 15:29:50 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '1fcd5523-b602-40ec-a4fd-19a177a5721c', 'status': 'completed', 'start_time': '2025-04-16T12:34:40.860273+00:00', 'end_time': '2025-04-16T12:34:50.497817+00:00', 'total_machines': 10, 'days_threshold': 0}
2025-04-16 15:29:50 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 15:29:51 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 15:29:59 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | WARNING  | services.database:get_batch_results:476 - No results found for batch b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | WARNING  | services.price_service:get_batch_results:300 - No batch data found for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | WARNING  | api.routes:get_batch_results:198 - No batch results found for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:29:59 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:30:00 | WARNING  | services.database:get_batch_results:476 - No results found for batch b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:30:00 | WARNING  | services.price_service:get_batch_results:300 - No batch data found for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:30:00 | WARNING  | api.routes:get_batch_results:198 - No batch results found for batch_id: b3cc1c8c-7375-4d37-b16d-8040a807c969
2025-04-16 15:30:07 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 15:30:07 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 15:30:08 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 15:30:08 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 1fcd5523-b602-40ec-a4fd-19a177a5721c
2025-04-16 15:40:22 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:40:22 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:40:22 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:40:22 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:43:19 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 15:43:20 | INFO     | api.routes:get_batches:292 - No batch jobs found in database
2025-04-16 15:43:20 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 15:43:20 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 15:43:36 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 15:43:36 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 15:43:40 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 15:43:41 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:43:41 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=10
2025-04-16 15:43:41 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:44:01 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=25
2025-04-16 15:44:01 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:44:01 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=25
2025-04-16 15:44:01 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:44:03 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=50
2025-04-16 15:44:03 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:44:04 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=0, limit=50
2025-04-16 15:44:04 | INFO     | services.database:get_machines_needing_update:252 - Found 150 machines for price update
2025-04-16 15:44:08 | INFO     | api.routes:batch_update_machines:115 - Batch update request with days=0, limit=50, machine_ids=['c23808f6-1760-4cad-b031-3c5eb3556d98', 'ff1f2676-9e67-47bf-9bb0-7152bace66b5', 'ef4f7a07-a068-4afc-b550-22d101c6e68b', 'e4093bf6-7a1c-4325-9094-8c572a307459', 'b2956e47-a9da-4359-8c88-42ca9a8740e7']
2025-04-16 15:44:08 | INFO     | services.price_service:batch_update_machines:210 - Starting batch update with days_threshold=0, limit=50, machine_ids=50
2025-04-16 15:44:08 | INFO     | services.price_service:batch_update_machines:214 - Using 50 provided machine IDs for batch update
2025-04-16 15:44:08 | INFO     | services.database:get_machines_needing_update:252 - Found 50 machines for price update
2025-04-16 15:44:08 | INFO     | services.price_service:batch_update_machines:225 - Starting batch update for 50 machines
2025-04-16 15:44:08 | INFO     | services.database:create_batch:303 - Creating new batch with ID 2e001700-5ff3-4f7f-a8da-59e2dd133d43 for 50 machines
2025-04-16 15:44:08 | INFO     | services.database:create_batch:333 - Successfully created batch record with ID 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:08 | INFO     | services.database:create_batch:343 - Verified batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43 exists in database
2025-04-16 15:44:08 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:44:08 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:44:09 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.89 seconds
2025-04-16 15:44:09 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:44:10 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:10 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:44:10 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:44:10 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:44:10 | INFO     | services.database:add_batch_result:448 - Added result for machine c23808f6-1760-4cad-b031-3c5eb3556d98 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:10 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 15:44:10 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 15:44:11 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.31 seconds
2025-04-16 15:44:11 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/mira-s
2025-04-16 15:44:11 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:11 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/mira-s using any method
2025-04-16 15:44:11 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5 at URL: https://aeonlaser.us/mira-s
2025-04-16 15:44:11 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5
2025-04-16 15:44:11 | INFO     | services.database:add_batch_result:448 - Added result for machine ff1f2676-9e67-47bf-9bb0-7152bace66b5 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:11 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 15:44:11 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/supernova-s
2025-04-16 15:44:11 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/supernova-s in 0.07 seconds
2025-04-16 15:44:11 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/supernova-s
2025-04-16 15:44:12 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:12 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/supernova-s using any method
2025-04-16 15:44:12 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine ef4f7a07-a068-4afc-b550-22d101c6e68b at URL: https://aeonlaser.us/supernova-s
2025-04-16 15:44:12 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ef4f7a07-a068-4afc-b550-22d101c6e68b
2025-04-16 15:44:12 | INFO     | services.database:add_batch_result:448 - Added result for machine ef4f7a07-a068-4afc-b550-22d101c6e68b to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:12 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 15:44:12 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-04-16 15:44:13 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739 in 0.55 seconds
2025-04-16 15:44:13 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-04-16 15:44:13 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:13 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739 using any method
2025-04-16 15:44:13 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine e4093bf6-7a1c-4325-9094-8c572a307459 at URL: https://algolaser.com/products/algolaser-diy-kit-mk2-diode-laser-engraver?variant=50120360231219&z_code=p12712591847425122453&z_pid=135739
2025-04-16 15:44:13 | INFO     | services.database:add_price_history:159 - Added price history entry for machine e4093bf6-7a1c-4325-9094-8c572a307459
2025-04-16 15:44:14 | INFO     | services.database:add_batch_result:448 - Added result for machine e4093bf6-7a1c-4325-9094-8c572a307459 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:14 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 15:44:14 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-04-16 15:44:15 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum in 0.87 seconds
2025-04-16 15:44:15 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-04-16 15:44:15 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:15 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum using any method
2025-04-16 15:44:15 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 at URL: https://omtechlaser.com/products/galvo-fiber-30-30w-integrated-fiber-laser-marker-engraving-machine-with-5-9x-5-9-working-area-for-metal?sca_ref=2167975.eUaAiFuxut&utm_source=affiliate&utm_medium=kols&utm_campaign=brandon-cullum
2025-04-16 15:44:15 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b2956e47-a9da-4359-8c88-42ca9a8740e7
2025-04-16 15:44:15 | INFO     | services.database:add_batch_result:448 - Added result for machine b2956e47-a9da-4359-8c88-42ca9a8740e7 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:15 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 15:44:16 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 15:44:16 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser in 0.66 seconds
2025-04-16 15:44:16 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 15:44:17 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:17 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser using any method
2025-04-16 15:44:17 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 at URL: https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 15:44:17 | INFO     | services.database:add_price_history:159 - Added price history entry for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 15:44:17 | INFO     | services.database:add_batch_result:448 - Added result for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:17 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 15:44:17 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-04-16 15:44:18 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742 in 0.63 seconds
2025-04-16 15:44:18 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-04-16 15:44:18 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:18 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742 using any method
2025-04-16 15:44:18 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c at URL: https://algolaser.com/products/algolaser-diy-kit-mini-laser-engraver?variant=48598666674483&z_code=p12712591847425122453&z_pid=135742
2025-04-16 15:44:18 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c
2025-04-16 15:44:19 | INFO     | services.database:add_batch_result:448 - Added result for machine 47b8dc18-5daa-4a2b-8ff8-9b48b176db9c to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:19 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 15:44:19 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/mira-s
2025-04-16 15:44:19 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/mira-s in 0.06 seconds
2025-04-16 15:44:19 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/mira-s
2025-04-16 15:44:19 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:19 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/mira-s using any method
2025-04-16 15:44:19 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 at URL: https://aeonlaser.us/mira-s
2025-04-16 15:44:19 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836
2025-04-16 15:44:19 | INFO     | services.database:add_batch_result:448 - Added result for machine 8a0ad4b4-b616-4e5d-85a3-5631ab388836 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:19 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 15:44:19 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/nova-s
2025-04-16 15:44:19 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/nova-s in 0.06 seconds
2025-04-16 15:44:19 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/nova-s
2025-04-16 15:44:19 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:19 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/nova-s using any method
2025-04-16 15:44:19 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f at URL: https://aeonlaser.us/nova-s
2025-04-16 15:44:20 | INFO     | services.database:add_price_history:159 - Added price history entry for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f
2025-04-16 15:44:20 | INFO     | services.database:add_batch_result:448 - Added result for machine dbf8b0cf-e699-4b6f-bb68-f30c0d163c0f to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:20 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 15:44:20 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area
2025-04-16 15:44:21 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area in 0.88 seconds
2025-04-16 15:44:21 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area
2025-04-16 15:44:21 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:21 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area using any method
2025-04-16 15:44:21 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403 at URL: https://www.cloudraylaser.com/collections/cloudray-engraver-machine/products/qs-30-litemarker-30w-split-laser-engraver-fiber-marking-machine-with-4-3-x-4-3-7-9-x-7-9-working-area
2025-04-16 15:44:21 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403
2025-04-16 15:44:22 | INFO     | services.database:add_batch_result:448 - Added result for machine 9536b86b-2d53-4bc8-b6d7-7a41e71b1403 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:22 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93
2025-04-16 15:44:22 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:22 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc in 0.45 seconds
2025-04-16 15:44:22 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:22 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:22 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc using any method
2025-04-16 15:44:22 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93 at URL: https://commarker.com/product/b4-100w-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:23 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93
2025-04-16 15:44:23 | INFO     | services.database:add_batch_result:448 - Added result for machine 1f4a6f8d-5f34-4190-a1f3-2c33c42e7e93 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:23 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 103db02f-7852-41f8-b297-162d479eaa39
2025-04-16 15:44:23 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:23 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc in 0.11 seconds
2025-04-16 15:44:23 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:23 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:23 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc using any method
2025-04-16 15:44:23 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 103db02f-7852-41f8-b297-162d479eaa39 at URL: https://commarker.com/product/b4-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:23 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 103db02f-7852-41f8-b297-162d479eaa39
2025-04-16 15:44:24 | INFO     | services.database:add_batch_result:448 - Added result for machine 103db02f-7852-41f8-b297-162d479eaa39 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:24 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ebd7976d-9fa0-4142-84cf-065d7adcb870
2025-04-16 15:44:24 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.atomstack.net/collections/x-series/products/atomstack-x70-max-360w-laser-engraver
2025-04-16 15:44:25 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.atomstack.net/collections/x-series/products/atomstack-x70-max-360w-laser-engraver in 0.77 seconds
2025-04-16 15:44:25 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.atomstack.net/collections/x-series/products/atomstack-x70-max-360w-laser-engraver
2025-04-16 15:44:25 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:25 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.atomstack.net/collections/x-series/products/atomstack-x70-max-360w-laser-engraver using any method
2025-04-16 15:44:25 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine ebd7976d-9fa0-4142-84cf-065d7adcb870 at URL: https://www.atomstack.net/collections/x-series/products/atomstack-x70-max-360w-laser-engraver
2025-04-16 15:44:25 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ebd7976d-9fa0-4142-84cf-065d7adcb870
2025-04-16 15:44:25 | INFO     | services.database:add_batch_result:448 - Added result for machine ebd7976d-9fa0-4142-84cf-065d7adcb870 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:25 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 58673ae1-b44e-4bc0-8d01-ce4878a44c86
2025-04-16 15:44:25 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g6-split-30w-60w-100w-fiber-laser-marking-engraving-machine-1?ref=NMV3sU0i
2025-04-16 15:44:26 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g6-split-30w-60w-100w-fiber-laser-marking-engraving-machine-1?ref=NMV3sU0i in 0.61 seconds
2025-04-16 15:44:26 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g6-split-30w-60w-100w-fiber-laser-marking-engraving-machine-1?ref=NMV3sU0i
2025-04-16 15:44:26 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:26 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g6-split-30w-60w-100w-fiber-laser-marking-engraving-machine-1?ref=NMV3sU0i using any method
2025-04-16 15:44:26 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 58673ae1-b44e-4bc0-8d01-ce4878a44c86 at URL: https://www.gweikecloud.com/products/g6-split-30w-60w-100w-fiber-laser-marking-engraving-machine-1?ref=NMV3sU0i
2025-04-16 15:44:26 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 58673ae1-b44e-4bc0-8d01-ce4878a44c86
2025-04-16 15:44:27 | INFO     | services.database:add_batch_result:448 - Added result for machine 58673ae1-b44e-4bc0-8d01-ce4878a44c86 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:27 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 15:44:27 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area
2025-04-16 15:44:27 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area in 0.45 seconds
2025-04-16 15:44:28 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area
2025-04-16 15:44:28 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:28 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area using any method
2025-04-16 15:44:28 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine d3707433-2475-4b6c-8007-1e7126afd86c at URL: https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area
2025-04-16 15:44:28 | INFO     | services.database:add_price_history:159 - Added price history entry for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 15:44:28 | INFO     | services.database:add_batch_result:448 - Added result for machine d3707433-2475-4b6c-8007-1e7126afd86c to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:28 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 839e1b00-8496-478a-96c4-6248ce74ce74
2025-04-16 15:44:28 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/b4-30w-laser-engraver-machine/?ref=snlyaljc
2025-04-16 15:44:28 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/b4-30w-laser-engraver-machine/?ref=snlyaljc in 0.11 seconds
2025-04-16 15:44:29 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/b4-30w-laser-engraver-machine/?ref=snlyaljc
2025-04-16 15:44:29 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:29 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/b4-30w-laser-engraver-machine/?ref=snlyaljc using any method
2025-04-16 15:44:29 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 839e1b00-8496-478a-96c4-6248ce74ce74 at URL: https://commarker.com/product/b4-30w-laser-engraver-machine/?ref=snlyaljc
2025-04-16 15:44:29 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 839e1b00-8496-478a-96c4-6248ce74ce74
2025-04-16 15:44:29 | INFO     | services.database:add_batch_result:448 - Added result for machine 839e1b00-8496-478a-96c4-6248ce74ce74 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:29 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 3809e3cd-9d7b-473a-9d68-2beea84c3da5
2025-04-16 15:44:29 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://omtechlaser.com/products/60w-co2-laser-engraver-with-16-x-24-working-area?sca_ref=2167975.eUaAiFuxut&utm_campaign=brandon-cullum&utm_medium=kols&utm_source=affiliate
2025-04-16 15:44:30 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://omtechlaser.com/products/60w-co2-laser-engraver-with-16-x-24-working-area?sca_ref=2167975.eUaAiFuxut&utm_campaign=brandon-cullum&utm_medium=kols&utm_source=affiliate in 0.47 seconds
2025-04-16 15:44:30 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://omtechlaser.com/products/60w-co2-laser-engraver-with-16-x-24-working-area?sca_ref=2167975.eUaAiFuxut&utm_campaign=brandon-cullum&utm_medium=kols&utm_source=affiliate
2025-04-16 15:44:30 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:30 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://omtechlaser.com/products/60w-co2-laser-engraver-with-16-x-24-working-area?sca_ref=2167975.eUaAiFuxut&utm_campaign=brandon-cullum&utm_medium=kols&utm_source=affiliate using any method
2025-04-16 15:44:30 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 3809e3cd-9d7b-473a-9d68-2beea84c3da5 at URL: https://omtechlaser.com/products/60w-co2-laser-engraver-with-16-x-24-working-area?sca_ref=2167975.eUaAiFuxut&utm_campaign=brandon-cullum&utm_medium=kols&utm_source=affiliate
2025-04-16 15:44:30 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 3809e3cd-9d7b-473a-9d68-2beea84c3da5
2025-04-16 15:44:30 | INFO     | services.database:add_batch_result:448 - Added result for machine 3809e3cd-9d7b-473a-9d68-2beea84c3da5 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:30 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine af474938-178d-4797-ac32-4426e73e43b2
2025-04-16 15:44:31 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:31 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/commarker-b6/?ref=snlyaljc in 0.10 seconds
2025-04-16 15:44:31 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:31 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:31 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/commarker-b6/?ref=snlyaljc using any method
2025-04-16 15:44:31 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine af474938-178d-4797-ac32-4426e73e43b2 at URL: https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:31 | INFO     | services.database:add_price_history:159 - Added price history entry for machine af474938-178d-4797-ac32-4426e73e43b2
2025-04-16 15:44:31 | INFO     | services.database:add_batch_result:448 - Added result for machine af474938-178d-4797-ac32-4426e73e43b2 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:31 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 7520f7f7-8ba9-4b77-b5ae-f5480f943b6c
2025-04-16 15:44:32 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:32 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc in 0.10 seconds
2025-04-16 15:44:32 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:32 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:32 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc using any method
2025-04-16 15:44:32 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 7520f7f7-8ba9-4b77-b5ae-f5480f943b6c at URL: https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:32 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 7520f7f7-8ba9-4b77-b5ae-f5480f943b6c
2025-04-16 15:44:32 | INFO     | services.database:add_batch_result:448 - Added result for machine 7520f7f7-8ba9-4b77-b5ae-f5480f943b6c to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:32 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine d94ed1c2-9dba-47e4-9600-5af55564afaa
2025-04-16 15:44:33 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:33 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc in 0.10 seconds
2025-04-16 15:44:33 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:33 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:33 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc using any method
2025-04-16 15:44:33 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine d94ed1c2-9dba-47e4-9600-5af55564afaa at URL: https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:33 | INFO     | services.database:add_price_history:159 - Added price history entry for machine d94ed1c2-9dba-47e4-9600-5af55564afaa
2025-04-16 15:44:34 | INFO     | services.database:add_batch_result:448 - Added result for machine d94ed1c2-9dba-47e4-9600-5af55564afaa to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:34 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6
2025-04-16 15:44:34 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://store.creality.com/products/falcon2-22w-laser-engraver-cutter
2025-04-16 15:44:36 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://store.creality.com/products/falcon2-22w-laser-engraver-cutter in 2.15 seconds
2025-04-16 15:44:36 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://store.creality.com/products/falcon2-22w-laser-engraver-cutter
2025-04-16 15:44:36 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:36 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://store.creality.com/products/falcon2-22w-laser-engraver-cutter using any method
2025-04-16 15:44:36 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6 at URL: https://store.creality.com/products/falcon2-22w-laser-engraver-cutter
2025-04-16 15:44:36 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6
2025-04-16 15:44:36 | INFO     | services.database:add_batch_result:448 - Added result for machine 1cbe702f-501f-4491-8e78-38c0e4bf7bb6 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:36 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine d910f7fc-a8e0-48ad-8a62-78c9e4259b8b
2025-04-16 15:44:37 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:37 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/commarker-b6/?ref=snlyaljc in 0.12 seconds
2025-04-16 15:44:37 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:37 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:37 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/commarker-b6/?ref=snlyaljc using any method
2025-04-16 15:44:37 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine d910f7fc-a8e0-48ad-8a62-78c9e4259b8b at URL: https://commarker.com/product/commarker-b6/?ref=snlyaljc
2025-04-16 15:44:37 | INFO     | services.database:add_price_history:159 - Added price history entry for machine d910f7fc-a8e0-48ad-8a62-78c9e4259b8b
2025-04-16 15:44:37 | INFO     | services.database:add_batch_result:448 - Added result for machine d910f7fc-a8e0-48ad-8a62-78c9e4259b8b to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:37 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 3b2a82b6-7496-43b8-ad2d-dc663c7b5a04
2025-04-16 15:44:38 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/b4-50w-fiber-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:38 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/b4-50w-fiber-laser-engraver/?ref=snlyaljc in 0.10 seconds
2025-04-16 15:44:38 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/b4-50w-fiber-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:38 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:38 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/b4-50w-fiber-laser-engraver/?ref=snlyaljc using any method
2025-04-16 15:44:38 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 3b2a82b6-7496-43b8-ad2d-dc663c7b5a04 at URL: https://commarker.com/product/b4-50w-fiber-laser-engraver/?ref=snlyaljc
2025-04-16 15:44:38 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 3b2a82b6-7496-43b8-ad2d-dc663c7b5a04
2025-04-16 15:44:38 | INFO     | services.database:add_batch_result:448 - Added result for machine 3b2a82b6-7496-43b8-ad2d-dc663c7b5a04 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:38 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b6824b08-7270-464c-82f3-3d31c439fbe3
2025-04-16 15:44:39 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:39 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc in 0.14 seconds
2025-04-16 15:44:39 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:39 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:39 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc using any method
2025-04-16 15:44:39 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine b6824b08-7270-464c-82f3-3d31c439fbe3 at URL: https://commarker.com/product/commarker-b6-jpt-mopa/?ref=snlyaljc
2025-04-16 15:44:39 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b6824b08-7270-464c-82f3-3d31c439fbe3
2025-04-16 15:44:39 | INFO     | services.database:add_batch_result:448 - Added result for machine b6824b08-7270-464c-82f3-3d31c439fbe3 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:39 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 7d78d48e-932c-44c9-8f29-970ca508629f
2025-04-16 15:44:40 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.1laser.com/products/onelaser-xt-desktop-laser-machine
2025-04-16 15:44:41 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.1laser.com/products/onelaser-xt-desktop-laser-machine in 1.63 seconds
2025-04-16 15:44:41 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.1laser.com/products/onelaser-xt-desktop-laser-machine
2025-04-16 15:44:41 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:41 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.1laser.com/products/onelaser-xt-desktop-laser-machine using any method
2025-04-16 15:44:41 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 7d78d48e-932c-44c9-8f29-970ca508629f at URL: https://www.1laser.com/products/onelaser-xt-desktop-laser-machine
2025-04-16 15:44:41 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 7d78d48e-932c-44c9-8f29-970ca508629f
2025-04-16 15:44:42 | INFO     | services.database:add_batch_result:448 - Added result for machine 7d78d48e-932c-44c9-8f29-970ca508629f to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:42 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine e353d187-82db-4fe4-bbf3-2bd859516b4c
2025-04-16 15:44:42 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://shop.epiloglaser.com/products/fusion-maker-12
2025-04-16 15:44:42 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://shop.epiloglaser.com/products/fusion-maker-12 in 0.36 seconds
2025-04-16 15:44:42 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://shop.epiloglaser.com/products/fusion-maker-12
2025-04-16 15:44:42 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:42 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://shop.epiloglaser.com/products/fusion-maker-12 using any method
2025-04-16 15:44:42 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine e353d187-82db-4fe4-bbf3-2bd859516b4c at URL: https://shop.epiloglaser.com/products/fusion-maker-12
2025-04-16 15:44:43 | INFO     | services.database:add_price_history:159 - Added price history entry for machine e353d187-82db-4fe4-bbf3-2bd859516b4c
2025-04-16 15:44:43 | INFO     | services.database:add_batch_result:448 - Added result for machine e353d187-82db-4fe4-bbf3-2bd859516b4c to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:43 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c279ded1-1f68-4492-9f3d-5e07e07eb023
2025-04-16 15:44:43 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/emp-laser
2025-04-16 15:44:43 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/emp-laser in 0.22 seconds
2025-04-16 15:44:43 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/emp-laser
2025-04-16 15:44:43 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:43 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/emp-laser using any method
2025-04-16 15:44:43 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c279ded1-1f68-4492-9f3d-5e07e07eb023 at URL: https://aeonlaser.us/emp-laser
2025-04-16 15:44:43 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c279ded1-1f68-4492-9f3d-5e07e07eb023
2025-04-16 15:44:44 | INFO     | services.database:add_batch_result:448 - Added result for machine c279ded1-1f68-4492-9f3d-5e07e07eb023 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:44 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 01cedfc4-fc89-4930-b258-90bb778e528e
2025-04-16 15:44:44 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://em-smart.com/collections/super/products/em-smart-super-30w-50w-fiber-laser-engraver-with-rotary?utm_source=ytb_brandon&utm_medium=referral&utm_campaign=brandon_em01
2025-04-16 15:44:45 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://em-smart.com/collections/super/products/em-smart-super-30w-50w-fiber-laser-engraver-with-rotary?utm_source=ytb_brandon&utm_medium=referral&utm_campaign=brandon_em01 in 1.52 seconds
2025-04-16 15:44:45 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://em-smart.com/collections/super/products/em-smart-super-30w-50w-fiber-laser-engraver-with-rotary?utm_source=ytb_brandon&utm_medium=referral&utm_campaign=brandon_em01
2025-04-16 15:44:45 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:45 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://em-smart.com/collections/super/products/em-smart-super-30w-50w-fiber-laser-engraver-with-rotary?utm_source=ytb_brandon&utm_medium=referral&utm_campaign=brandon_em01 using any method
2025-04-16 15:44:45 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 01cedfc4-fc89-4930-b258-90bb778e528e at URL: https://em-smart.com/collections/super/products/em-smart-super-30w-50w-fiber-laser-engraver-with-rotary?utm_source=ytb_brandon&utm_medium=referral&utm_campaign=brandon_em01
2025-04-16 15:44:46 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 01cedfc4-fc89-4930-b258-90bb778e528e
2025-04-16 15:44:46 | INFO     | services.database:add_batch_result:448 - Added result for machine 01cedfc4-fc89-4930-b258-90bb778e528e to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:46 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 533f1772-4dc1-4239-8eb3-38cc598933b3
2025-04-16 15:44:46 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-24
2025-04-16 15:44:46 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-24 in 0.22 seconds
2025-04-16 15:44:46 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-24
2025-04-16 15:44:46 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:46 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-24 using any method
2025-04-16 15:44:46 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 533f1772-4dc1-4239-8eb3-38cc598933b3 at URL: https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-24
2025-04-16 15:44:46 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 533f1772-4dc1-4239-8eb3-38cc598933b3
2025-04-16 15:44:47 | INFO     | services.database:add_batch_result:448 - Added result for machine 533f1772-4dc1-4239-8eb3-38cc598933b3 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:47 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 4e9d52a3-2c62-4c10-8dd9-f8b0d5ff7715
2025-04-16 15:44:47 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-36
2025-04-16 15:44:47 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-36 in 0.27 seconds
2025-04-16 15:44:47 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-36
2025-04-16 15:44:47 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:47 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-36 using any method
2025-04-16 15:44:47 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 4e9d52a3-2c62-4c10-8dd9-f8b0d5ff7715 at URL: https://shop.epiloglaser.com/collections/epilog-laser-engraving-and-cutting-systems/products/fusion-maker-36
2025-04-16 15:44:47 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 4e9d52a3-2c62-4c10-8dd9-f8b0d5ff7715
2025-04-16 15:44:47 | INFO     | services.database:add_batch_result:448 - Added result for machine 4e9d52a3-2c62-4c10-8dd9-f8b0d5ff7715 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:47 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8a7e16be-397e-43fe-8b5c-75a3f6f504fb
2025-04-16 15:44:48 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/emp-laser
2025-04-16 15:44:48 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/emp-laser in 0.07 seconds
2025-04-16 15:44:48 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/emp-laser
2025-04-16 15:44:48 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:48 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/emp-laser using any method
2025-04-16 15:44:48 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 8a7e16be-397e-43fe-8b5c-75a3f6f504fb at URL: https://aeonlaser.us/emp-laser
2025-04-16 15:44:48 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 8a7e16be-397e-43fe-8b5c-75a3f6f504fb
2025-04-16 15:44:48 | INFO     | services.database:add_batch_result:448 - Added result for machine 8a7e16be-397e-43fe-8b5c-75a3f6f504fb to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:48 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine d14d3459-7c00-4a82-aa26-4e6df27f1aa1
2025-04-16 15:44:48 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/emp-laser
2025-04-16 15:44:48 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/emp-laser in 0.06 seconds
2025-04-16 15:44:48 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/emp-laser
2025-04-16 15:44:48 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:48 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/emp-laser using any method
2025-04-16 15:44:48 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine d14d3459-7c00-4a82-aa26-4e6df27f1aa1 at URL: https://aeonlaser.us/emp-laser
2025-04-16 15:44:49 | INFO     | services.database:add_price_history:159 - Added price history entry for machine d14d3459-7c00-4a82-aa26-4e6df27f1aa1
2025-04-16 15:44:49 | INFO     | services.database:add_batch_result:448 - Added result for machine d14d3459-7c00-4a82-aa26-4e6df27f1aa1 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:49 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 4efe1038-29b8-47c8-972d-5591370964ec
2025-04-16 15:44:49 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://aeonlaser.us/emp-laser
2025-04-16 15:44:49 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://aeonlaser.us/emp-laser in 0.07 seconds
2025-04-16 15:44:49 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://aeonlaser.us/emp-laser
2025-04-16 15:44:49 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:49 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://aeonlaser.us/emp-laser using any method
2025-04-16 15:44:49 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 4efe1038-29b8-47c8-972d-5591370964ec at URL: https://aeonlaser.us/emp-laser
2025-04-16 15:44:49 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 4efe1038-29b8-47c8-972d-5591370964ec
2025-04-16 15:44:49 | INFO     | services.database:add_batch_result:448 - Added result for machine 4efe1038-29b8-47c8-972d-5591370964ec to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:49 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 4923b2ee-8a9e-4743-9643-af7c91feb806
2025-04-16 15:44:49 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.thunderlaserusa.com/aurora-8-mopa/
2025-04-16 15:44:50 | ERROR    | scrapers.web_scraper:get_page_content:54 - HTTP error when fetching https://www.thunderlaserusa.com/aurora-8-mopa/: 403 Client Error: Forbidden for url: https://www.thunderlaserusa.com/aurora-8-mopa/
2025-04-16 15:44:50 | ERROR    | services.price_service:update_machine_price:72 - Failed to scrape page for machine 4923b2ee-8a9e-4743-9643-af7c91feb806 at URL: https://www.thunderlaserusa.com/aurora-8-mopa/
2025-04-16 15:44:50 | INFO     | services.database:add_batch_result:448 - Added result for machine 4923b2ee-8a9e-4743-9643-af7c91feb806 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:50 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 785d8c3b-3d74-4755-b78b-98345c443b63
2025-04-16 15:44:50 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://rolyautomation.com/products/lasermatic-mk2-diode-laser-engraver?bg_ref=rZxaOxidn5
2025-04-16 15:44:51 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://rolyautomation.com/products/lasermatic-mk2-diode-laser-engraver?bg_ref=rZxaOxidn5 in 0.66 seconds
2025-04-16 15:44:51 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://rolyautomation.com/products/lasermatic-mk2-diode-laser-engraver?bg_ref=rZxaOxidn5
2025-04-16 15:44:51 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:51 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://rolyautomation.com/products/lasermatic-mk2-diode-laser-engraver?bg_ref=rZxaOxidn5 using any method
2025-04-16 15:44:51 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 785d8c3b-3d74-4755-b78b-98345c443b63 at URL: https://rolyautomation.com/products/lasermatic-mk2-diode-laser-engraver?bg_ref=rZxaOxidn5
2025-04-16 15:44:51 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 785d8c3b-3d74-4755-b78b-98345c443b63
2025-04-16 15:44:51 | INFO     | services.database:add_batch_result:448 - Added result for machine 785d8c3b-3d74-4755-b78b-98345c443b63 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:51 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 6f02d540-d04a-4873-905e-450ec42615f7
2025-04-16 15:44:51 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g2-50w-fiber-laser-engraver?ref=eXZYQTHYc7dy_6
2025-04-16 15:44:52 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g2-50w-fiber-laser-engraver?ref=eXZYQTHYc7dy_6 in 0.42 seconds
2025-04-16 15:44:52 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g2-50w-fiber-laser-engraver?ref=eXZYQTHYc7dy_6
2025-04-16 15:44:52 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:52 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g2-50w-fiber-laser-engraver?ref=eXZYQTHYc7dy_6 using any method
2025-04-16 15:44:52 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 6f02d540-d04a-4873-905e-450ec42615f7 at URL: https://www.gweikecloud.com/products/g2-50w-fiber-laser-engraver?ref=eXZYQTHYc7dy_6
2025-04-16 15:44:52 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 6f02d540-d04a-4873-905e-450ec42615f7
2025-04-16 15:44:52 | INFO     | services.database:add_batch_result:448 - Added result for machine 6f02d540-d04a-4873-905e-450ec42615f7 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:52 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine ba985fae-8f77-439a-a631-f66f1c8af245
2025-04-16 15:44:52 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://glowforge.com/b/pro
2025-04-16 15:44:56 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://glowforge.com/b/pro in 3.26 seconds
2025-04-16 15:44:56 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://glowforge.com/b/pro
2025-04-16 15:44:56 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:56 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://glowforge.com/b/pro using any method
2025-04-16 15:44:56 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine ba985fae-8f77-439a-a631-f66f1c8af245 at URL: https://glowforge.com/b/pro
2025-04-16 15:44:56 | INFO     | services.database:add_price_history:159 - Added price history entry for machine ba985fae-8f77-439a-a631-f66f1c8af245
2025-04-16 15:44:56 | INFO     | services.database:add_batch_result:448 - Added result for machine ba985fae-8f77-439a-a631-f66f1c8af245 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:56 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine a911e1a8-8e65-4e57-a366-c694cc7deeb8
2025-04-16 15:44:56 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://glowforge.com/b/craft
2025-04-16 15:44:58 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://glowforge.com/b/craft in 1.92 seconds
2025-04-16 15:44:58 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://glowforge.com/b/craft
2025-04-16 15:44:58 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:58 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://glowforge.com/b/craft using any method
2025-04-16 15:44:58 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine a911e1a8-8e65-4e57-a366-c694cc7deeb8 at URL: https://glowforge.com/b/craft
2025-04-16 15:44:59 | INFO     | services.database:add_price_history:159 - Added price history entry for machine a911e1a8-8e65-4e57-a366-c694cc7deeb8
2025-04-16 15:44:59 | INFO     | services.database:add_batch_result:448 - Added result for machine a911e1a8-8e65-4e57-a366-c694cc7deeb8 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:44:59 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 163b26bb-b096-4473-9a17-569c1cfb4f18
2025-04-16 15:44:59 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://shop.flux3dp.com/?sca_ref=3371875.vRA6wd3Afu
2025-04-16 15:44:59 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://shop.flux3dp.com/?sca_ref=3371875.vRA6wd3Afu in 0.40 seconds
2025-04-16 15:44:59 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://shop.flux3dp.com/?sca_ref=3371875.vRA6wd3Afu
2025-04-16 15:44:59 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:44:59 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://shop.flux3dp.com/?sca_ref=3371875.vRA6wd3Afu using any method
2025-04-16 15:44:59 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 163b26bb-b096-4473-9a17-569c1cfb4f18 at URL: https://shop.flux3dp.com/?sca_ref=3371875.vRA6wd3Afu
2025-04-16 15:45:00 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 163b26bb-b096-4473-9a17-569c1cfb4f18
2025-04-16 15:45:00 | INFO     | services.database:add_batch_result:448 - Added result for machine 163b26bb-b096-4473-9a17-569c1cfb4f18 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:00 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine f4370877-a40c-459d-ab83-e93a32d102fb
2025-04-16 15:45:00 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.amazon.com/dp/B0CMTL5QSJ?tag=brancull-20&th=1&psc=1&geniuslink=true
2025-04-16 15:45:03 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.amazon.com/dp/B0CMTL5QSJ?tag=brancull-20&th=1&psc=1&geniuslink=true in 2.88 seconds
2025-04-16 15:45:03 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.amazon.com/dp/B0CMTL5QSJ?tag=brancull-20&th=1&psc=1&geniuslink=true
2025-04-16 15:45:03 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:03 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.amazon.com/dp/B0CMTL5QSJ?tag=brancull-20&th=1&psc=1&geniuslink=true using any method
2025-04-16 15:45:03 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine f4370877-a40c-459d-ab83-e93a32d102fb at URL: https://www.amazon.com/dp/B0CMTL5QSJ?tag=brancull-20&th=1&psc=1&geniuslink=true
2025-04-16 15:45:03 | INFO     | services.database:add_price_history:159 - Added price history entry for machine f4370877-a40c-459d-ab83-e93a32d102fb
2025-04-16 15:45:04 | INFO     | services.database:add_batch_result:448 - Added result for machine f4370877-a40c-459d-ab83-e93a32d102fb to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:04 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 23372b1e-277f-4ad4-b9ee-715b05782894
2025-04-16 15:45:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g2-pro-series?ref=NMV3sU0i
2025-04-16 15:45:04 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g2-pro-series?ref=NMV3sU0i in 0.10 seconds
2025-04-16 15:45:04 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g2-pro-series?ref=NMV3sU0i
2025-04-16 15:45:04 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:04 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g2-pro-series?ref=NMV3sU0i using any method
2025-04-16 15:45:04 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 23372b1e-277f-4ad4-b9ee-715b05782894 at URL: https://www.gweikecloud.com/products/g2-pro-series?ref=NMV3sU0i
2025-04-16 15:45:04 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 23372b1e-277f-4ad4-b9ee-715b05782894
2025-04-16 15:45:04 | INFO     | services.database:add_batch_result:448 - Added result for machine 23372b1e-277f-4ad4-b9ee-715b05782894 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:04 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine fc6b76a8-1862-4b8f-a6a8-a2c71ba8c8f2
2025-04-16 15:45:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g2-pro-fiber-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:04 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g2-pro-fiber-laser-engraver?ref=NMV3sU0i in 0.15 seconds
2025-04-16 15:45:05 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g2-pro-fiber-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:05 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:05 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g2-pro-fiber-laser-engraver?ref=NMV3sU0i using any method
2025-04-16 15:45:05 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine fc6b76a8-1862-4b8f-a6a8-a2c71ba8c8f2 at URL: https://www.gweikecloud.com/products/g2-pro-fiber-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:05 | INFO     | services.database:add_price_history:159 - Added price history entry for machine fc6b76a8-1862-4b8f-a6a8-a2c71ba8c8f2
2025-04-16 15:45:05 | INFO     | services.database:add_batch_result:448 - Added result for machine fc6b76a8-1862-4b8f-a6a8-a2c71ba8c8f2 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:05 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b78b8088-9577-4047-a975-32472998e3e4
2025-04-16 15:45:05 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://glowforge.com/b/pro
2025-04-16 15:45:05 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://glowforge.com/b/pro in 0.08 seconds
2025-04-16 15:45:05 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://glowforge.com/b/pro
2025-04-16 15:45:05 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:05 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://glowforge.com/b/pro using any method
2025-04-16 15:45:05 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine b78b8088-9577-4047-a975-32472998e3e4 at URL: https://glowforge.com/b/pro
2025-04-16 15:45:05 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b78b8088-9577-4047-a975-32472998e3e4
2025-04-16 15:45:06 | INFO     | services.database:add_batch_result:448 - Added result for machine b78b8088-9577-4047-a975-32472998e3e4 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:06 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine b6cfba2d-fbcb-4769-af88-435fa2fd20c1
2025-04-16 15:45:06 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/gweikecloud-rf-metal-tube-laser-engraver-with-rotary
2025-04-16 15:45:06 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/gweikecloud-rf-metal-tube-laser-engraver-with-rotary in 0.39 seconds
2025-04-16 15:45:06 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/gweikecloud-rf-metal-tube-laser-engraver-with-rotary
2025-04-16 15:45:06 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:06 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/gweikecloud-rf-metal-tube-laser-engraver-with-rotary using any method
2025-04-16 15:45:06 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine b6cfba2d-fbcb-4769-af88-435fa2fd20c1 at URL: https://www.gweikecloud.com/products/gweikecloud-rf-metal-tube-laser-engraver-with-rotary
2025-04-16 15:45:06 | INFO     | services.database:add_price_history:159 - Added price history entry for machine b6cfba2d-fbcb-4769-af88-435fa2fd20c1
2025-04-16 15:45:07 | INFO     | services.database:add_batch_result:448 - Added result for machine b6cfba2d-fbcb-4769-af88-435fa2fd20c1 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:07 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c2769ef1-2ffd-4149-89cf-854b5ff78f81
2025-04-16 15:45:07 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/nox?ref=NMV3sU0i
2025-04-16 15:45:07 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/nox?ref=NMV3sU0i in 0.32 seconds
2025-04-16 15:45:07 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/nox?ref=NMV3sU0i
2025-04-16 15:45:07 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:07 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/nox?ref=NMV3sU0i using any method
2025-04-16 15:45:07 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c2769ef1-2ffd-4149-89cf-854b5ff78f81 at URL: https://www.gweikecloud.com/products/nox?ref=NMV3sU0i
2025-04-16 15:45:07 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c2769ef1-2ffd-4149-89cf-854b5ff78f81
2025-04-16 15:45:08 | INFO     | services.database:add_batch_result:448 - Added result for machine c2769ef1-2ffd-4149-89cf-854b5ff78f81 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:08 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 1c0c5313-9e75-4ee7-bb3f-e0854a9a2f91
2025-04-16 15:45:08 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g1-desktop-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:08 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g1-desktop-laser-engraver?ref=NMV3sU0i in 0.45 seconds
2025-04-16 15:45:08 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g1-desktop-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:08 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:08 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g1-desktop-laser-engraver?ref=NMV3sU0i using any method
2025-04-16 15:45:08 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 1c0c5313-9e75-4ee7-bb3f-e0854a9a2f91 at URL: https://www.gweikecloud.com/products/g1-desktop-laser-engraver?ref=NMV3sU0i
2025-04-16 15:45:08 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 1c0c5313-9e75-4ee7-bb3f-e0854a9a2f91
2025-04-16 15:45:09 | INFO     | services.database:add_batch_result:448 - Added result for machine 1c0c5313-9e75-4ee7-bb3f-e0854a9a2f91 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:09 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 0f68270e-ea6a-4538-bfd4-4daa7ed3d0d2
2025-04-16 15:45:09 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.gweikecloud.com/products/g6-mopa-30w-60w-100w-fiber-laser-marking-engraving-machine?ref=NMV3sU0i&variant=44232396144857
2025-04-16 15:45:09 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.gweikecloud.com/products/g6-mopa-30w-60w-100w-fiber-laser-marking-engraving-machine?ref=NMV3sU0i&variant=44232396144857 in 0.34 seconds
2025-04-16 15:45:09 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.gweikecloud.com/products/g6-mopa-30w-60w-100w-fiber-laser-marking-engraving-machine?ref=NMV3sU0i&variant=44232396144857
2025-04-16 15:45:09 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:09 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.gweikecloud.com/products/g6-mopa-30w-60w-100w-fiber-laser-marking-engraving-machine?ref=NMV3sU0i&variant=44232396144857 using any method
2025-04-16 15:45:09 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 0f68270e-ea6a-4538-bfd4-4daa7ed3d0d2 at URL: https://www.gweikecloud.com/products/g6-mopa-30w-60w-100w-fiber-laser-marking-engraving-machine?ref=NMV3sU0i&variant=44232396144857
2025-04-16 15:45:09 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 0f68270e-ea6a-4538-bfd4-4daa7ed3d0d2
2025-04-16 15:45:09 | INFO     | services.database:add_batch_result:448 - Added result for machine 0f68270e-ea6a-4538-bfd4-4daa7ed3d0d2 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:09 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine df2e8087-6878-478a-a7ca-31f95ae73197
2025-04-16 15:45:10 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://lagunatools.com/cnc/co2-lasers/smartshop-laser-ex/
2025-04-16 15:45:11 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://lagunatools.com/cnc/co2-lasers/smartshop-laser-ex/ in 1.10 seconds
2025-04-16 15:45:11 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://lagunatools.com/cnc/co2-lasers/smartshop-laser-ex/
2025-04-16 15:45:11 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:11 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://lagunatools.com/cnc/co2-lasers/smartshop-laser-ex/ using any method
2025-04-16 15:45:11 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine df2e8087-6878-478a-a7ca-31f95ae73197 at URL: https://lagunatools.com/cnc/co2-lasers/smartshop-laser-ex/
2025-04-16 15:45:11 | INFO     | services.database:add_price_history:159 - Added price history entry for machine df2e8087-6878-478a-a7ca-31f95ae73197
2025-04-16 15:45:11 | INFO     | services.database:add_batch_result:448 - Added result for machine df2e8087-6878-478a-a7ca-31f95ae73197 to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:11 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 2dff352f-d660-4210-afda-1d7bbea3611e
2025-04-16 15:45:12 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.longer3d.com/products/longer-ray5-laser-engraver
2025-04-16 15:45:13 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.longer3d.com/products/longer-ray5-laser-engraver in 1.10 seconds
2025-04-16 15:45:13 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.longer3d.com/products/longer-ray5-laser-engraver
2025-04-16 15:45:13 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:13 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.longer3d.com/products/longer-ray5-laser-engraver using any method
2025-04-16 15:45:13 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 2dff352f-d660-4210-afda-1d7bbea3611e at URL: https://www.longer3d.com/products/longer-ray5-laser-engraver
2025-04-16 15:45:13 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 2dff352f-d660-4210-afda-1d7bbea3611e
2025-04-16 15:45:13 | INFO     | services.database:add_batch_result:448 - Added result for machine 2dff352f-d660-4210-afda-1d7bbea3611e to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:13 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8a90b7a6-c8f6-4a0b-8ed6-c731d007557d
2025-04-16 15:45:14 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://www.longer3d.com/products/longer-nano-6w-12w-laser-engraving-machine
2025-04-16 15:45:14 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://www.longer3d.com/products/longer-nano-6w-12w-laser-engraving-machine in 0.58 seconds
2025-04-16 15:45:15 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://www.longer3d.com/products/longer-nano-6w-12w-laser-engraving-machine
2025-04-16 15:45:15 | ERROR    | scrapers.price_extractor:_extract_using_claude:228 - Error using Claude for price extraction: Error code: 401 - {'type': 'error', 'error': {'type': 'authentication_error', 'message': 'invalid x-api-key'}}
2025-04-16 15:45:15 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://www.longer3d.com/products/longer-nano-6w-12w-laser-engraving-machine using any method
2025-04-16 15:45:15 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine 8a90b7a6-c8f6-4a0b-8ed6-c731d007557d at URL: https://www.longer3d.com/products/longer-nano-6w-12w-laser-engraving-machine
2025-04-16 15:45:15 | INFO     | services.database:add_price_history:159 - Added price history entry for machine 8a90b7a6-c8f6-4a0b-8ed6-c731d007557d
2025-04-16 15:45:15 | INFO     | services.database:add_batch_result:448 - Added result for machine 8a90b7a6-c8f6-4a0b-8ed6-c731d007557d to batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:15 | INFO     | services.database:complete_batch:377 - Marked batch 2e001700-5ff3-4f7f-a8da-59e2dd133d43 as completed
2025-04-16 15:45:15 | INFO     | services.price_service:batch_update_machines:274 - Batch update completed. Results: 0 successful, 50 failed
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 15:45:18 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 15:45:28 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 15:45:29 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 15:45:29 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 15:45:29 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 15:45:29 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 15:45:35 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:35 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:36 | INFO     | api.routes:get_batch_results:191 - Fetching batch results for batch_id: 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:45:36 | INFO     | services.price_service:get_batch_results:293 - Retrieving batch results for batch_id: 2e001700-5ff3-4f7f-a8da-59e2dd133d43
2025-04-16 15:49:29 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:49:29 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:49:29 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:49:29 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:50:32 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:50:32 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:50:33 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:50:33 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.41 seconds
2025-04-16 15:50:33 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:50:34 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:50:34 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:50:34 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:50:34 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:50:34 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:51:46 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:51:46 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:51:46 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:51:46 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:51:59 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:51:59 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:52:00 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:52:01 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.78 seconds
2025-04-16 15:52:01 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:52:02 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:52:02 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:52:02 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:52:02 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:52:02 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:53:07 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:53:07 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:53:07 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:53:07 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:53:16 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:53:16 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:53:16 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:53:17 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.24 seconds
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:17 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:53:18 | WARNING  | scrapers.price_extractor:_parse_price:270 - TEMP DEBUG: Simplified parsing failed: [<class 'decimal.ConversionSyntax'>]. Falling back to original logic.
2025-04-16 15:53:18 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:53:18 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:53:18 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:53:18 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:53:18 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:54:12 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:54:12 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:54:12 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:54:12 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:54:25 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:54:25 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:54:25 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:54:26 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.36 seconds
2025-04-16 15:54:26 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:54:27 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:54:27 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:54:27 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:54:27 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:54:27 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:55:14 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:55:14 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:55:15 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:55:15 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.16 seconds
2025-04-16 15:55:15 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:55:16 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1299.00
2025-04-16 15:55:16 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:55:16 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:55:16 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:55:16 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:55:53 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:55:53 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:55:53 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:55:53 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:56:03 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:56:03 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:56:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:56:04 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.38 seconds
2025-04-16 15:56:04 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:56:05 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:56:05 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:56:05 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:56:05 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:56:05 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:57:16 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:57:16 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:57:16 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:57:17 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.25 seconds
2025-04-16 15:57:17 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:57:18 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:57:18 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:57:18 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:57:18 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:57:18 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:57:56 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 15:57:57 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 15:57:57 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 15:57:57 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 15:58:04 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:58:04 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:58:04 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:58:04 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.34 seconds
2025-04-16 15:58:05 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:58:05 | WARNING  | scrapers.price_extractor:_extract_using_claude:224 - Claude returned an invalid price: 1,299.00
2025-04-16 15:58:05 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 15:58:05 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 15:58:06 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 15:58:06 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:00:46 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:00:46 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:00:46 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:00:46 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:00:52 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:00:52 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:00:53 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:00:53 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.28 seconds
2025-04-16 16:00:53 | INFO     | scrapers.price_extractor:_extract_using_claude:200 - Calling Claude API to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:00:54 | WARNING  | scrapers.price_extractor:_extract_using_claude:250 - Claude returned an invalid price: 1,299.00
2025-04-16 16:00:54 | WARNING  | scrapers.price_extractor:extract_price:50 - Failed to extract price from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 using any method
2025-04-16 16:00:54 | ERROR    | services.price_service:update_machine_price:87 - Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:00:54 | INFO     | services.database:add_price_history:159 - Added price history entry for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:00:54 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to extract price for machine c23808f6-1760-4cad-b031-3c5eb3556d98 at URL: https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:03:02 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:03:02 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:03:02 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:03:02 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:03:18 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:03:18 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:03:18 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:03:18 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:03:38 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:03:38 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:03:39 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743
2025-04-16 16:03:40 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://algolaser.com/products/algolaser-delta-40w-diode-laser-engraver?variant=48652379029811&z_code=p12712591847425122453&z_pid=135743 in 0.83 seconds
2025-04-16 16:03:40 | INFO     | scrapers.price_extractor:_extract_from_structured_data:86 - Extracted price 129.0 using JSON-LD
2025-04-16 16:03:43 | WARNING  | services.database:update_machine_price:99 - No machine found with ID c23808f6-1760-4cad-b031-3c5eb3556d98 to update
2025-04-16 16:03:43 | ERROR    | services.price_service:update_machine_price:149 - Failed to update price in database for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:03:43 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine c23808f6-1760-4cad-b031-3c5eb3556d98: Failed to update price in database for machine c23808f6-1760-4cad-b031-3c5eb3556d98
2025-04-16 16:04:50 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:04:50 | INFO     | services.price_service:update_machine_price:28 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:04:51 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 16:04:52 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.91 seconds
2025-04-16 16:04:52 | INFO     | scrapers.price_extractor:_extract_from_structured_data:86 - Extracted price 119.0 using JSON-LD
2025-04-16 16:04:55 | WARNING  | services.database:update_machine_price:99 - No machine found with ID 8054eeb8-504f-4791-9f48-a99fe0669664 to update
2025-04-16 16:04:55 | ERROR    | services.price_service:update_machine_price:149 - Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:04:55 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine 8054eeb8-504f-4791-9f48-a99fe0669664: Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:06:02 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:03 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:03 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:03 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 16:06:03 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 16:06:20 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:20 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:20 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:21 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:22 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:22 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:23 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:24 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:24 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:28 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:28 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:28 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:31 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:31 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:31 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:33 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:34 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:34 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:36 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:36 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:36 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:06:40 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:06:40 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:06:40 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:08:05 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:08:05 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:08:05 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:08:05 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:08:17 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:08:17 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:08:17 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:08:17 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:09:02 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:09:02 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:09:02 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:09:02 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:09:29 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 16:09:29 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 16:09:29 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:09:29 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:09:29 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:09:32 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:09:32 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:09:32 | INFO     | scrapers.web_scraper:get_page_content:35 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 16:09:32 | INFO     | scrapers.web_scraper:get_page_content:42 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.32 seconds
2025-04-16 16:09:32 | ERROR    | services.price_service:update_machine_price:179 - Error processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664: object tuple can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 64, in <module>
    start()
    └ <function start at 0x114031120>

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/main.py", line 55, in start
    uvicorn.run(
    │       └ <function run at 0x105ba32e0>
    └ <module 'uvicorn' from '/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/__init__.py'>

  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/main.py", line 580, in run
    server.run()
    │      └ <function Server.run at 0x105c00540>
    └ <uvicorn.server.Server object at 0x114017a10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x105c005e0>
           │       │   └ <uvicorn.server.Server object at 0x114017a10>
           │       └ <function run at 0x105284e00>
           └ <module 'asyncio' from '/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/__init__.py'>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x113dbe6b0>
           │      └ <function Runner.run at 0x105424720>
           └ <asyncio.runners.Runner object at 0x114045b10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvic...
           │    │     └ <cyfunction Loop.run_until_complete at 0x114052670>
           │    └ <uvloop.Loop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x114045b10>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x114085410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x11406fe90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x114085410>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1142082d0>
          └ <fastapi.applications.FastAPI object at 0x11406fe90>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1140f1940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1140ef8d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1142082d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '53', 'sec-ch-ua-platform': '"macOS"', 'user...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1140f1940>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x111095760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1140ef8d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1140ef8d0>>, sen...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1142004d0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1140ef8d0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x1140ef8d0>>, sen...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x114209590>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1140eca50>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1142004d0>
          └ <function wrap_app_handling_exceptions at 0x107ee07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f1d00>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x1140eca50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f1d00>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1140eca50>>
          └ <fastapi.routing.APIRouter object at 0x1140eca50>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f1d00>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x107ee1da0>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f1d00>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1140f04a0>
          └ APIRoute(path='/api/v1/update-price', name='update_machine_price', methods=['POST'])
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f1d00>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x114209e50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1140f1da0>
          └ <function wrap_app_handling_exceptions at 0x107ee07c0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1140f2660>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x1142277...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x1140f1da0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x114209e50>
                     └ <function get_request_handler.<locals>.app at 0x1140f0540>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x107ee18a0>
  File "/Users/brandoncullum/miniconda3/lib/python3.11/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': MachineUpdateRequest(machine_id='8054eeb8-504f-4791-9f48-a99fe0669664')}
                 │         └ <function update_machine_price at 0x113e2a840>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "/Users/brandoncullum/machines-for-makers/price-extractor-python/api/routes.py", line 53, in update_machine_price
    result = await price_service.update_machine_price(request.machine_id)
                   │             │                    │       └ '8054eeb8-504f-4791-9f48-a99fe0669664'
                   │             │                    └ MachineUpdateRequest(machine_id='8054eeb8-504f-4791-9f48-a99fe0669664')
                   │             └ <function PriceService.update_machine_price at 0x112baed40>
                   └ <services.price_service.PriceService object at 0x112c1a8d0>

> File "/Users/brandoncullum/machines-for-makers/price-extractor-python/services/price_service.py", line 49, in update_machine_price
    html_content, soup = await self.web_scraper.get_page_content(product_url)
                               │    │           │                └ 'https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver'
                               │    │           └ <function WebScraper.get_page_content at 0x11286bec0>
                               │    └ <scrapers.web_scraper.WebScraper object at 0x113e1bed0>
                               └ <services.price_service.PriceService object at 0x112c1a8d0>

TypeError: object tuple can't be used in 'await' expression
2025-04-16 16:09:32 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine 8054eeb8-504f-4791-9f48-a99fe0669664: An error occurred while processing the price update
2025-04-16 16:10:51 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:10:51 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:10:51 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:10:51 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:11:11 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:11:11 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:11:12 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:11:12 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:11:28 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 16:11:29 | INFO     | services.database:get_machines_needing_update:225 - No machines found for price update
2025-04-16 16:11:29 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:11:29 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:11:29 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:11:32 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:11:32 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:11:32 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 16:11:32 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.46 seconds
2025-04-16 16:11:32 | INFO     | scrapers.price_extractor:_extract_from_structured_data:97 - Extracted price 119.0 using JSON-LD
2025-04-16 16:11:35 | WARNING  | services.database:update_machine_price:99 - No machine found with ID 8054eeb8-504f-4791-9f48-a99fe0669664 to update
2025-04-16 16:11:35 | ERROR    | services.price_service:update_machine_price:142 - Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:11:35 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine 8054eeb8-504f-4791-9f48-a99fe0669664: Failed to update price in database for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:16:45 | INFO     | services.database:__init__:21 - Database service initialized
2025-04-16 16:16:45 | INFO     | scrapers.price_extractor:__init__:20 - Price extractor initialized with Anthropic version header
2025-04-16 16:16:45 | INFO     | services.price_service:__init__:16 - Price service initialized
2025-04-16 16:16:45 | INFO     | __main__:start:54 - Starting Price Extractor API on 0.0.0.0:8000
2025-04-16 16:16:56 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:16:57 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:16:57 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:16:57 | INFO     | api.routes:configure_batch_update:244 - Configuring batch update with days_threshold=7, limit=10
2025-04-16 16:16:57 | INFO     | services.database:get_machines_needing_update:261 - No machines found for price update
2025-04-16 16:16:58 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:16:58 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:16:59 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver
2025-04-16 16:16:59 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://acmerlaser.com/products/acmer-p3-ir-diode-laser-engraver in 0.45 seconds
2025-04-16 16:16:59 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 1199.0 using JSON-LD
2025-04-16 16:16:59 | INFO     | services.price_service:update_machine_price:107 - Price unchanged for machine 8054eeb8-504f-4791-9f48-a99fe0669664: 1199.0
2025-04-16 16:16:59 | INFO     | services.database:add_price_history:195 - Added price history entry for machine 8054eeb8-504f-4791-9f48-a99fe0669664
2025-04-16 16:17:00 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:17:00 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:17:00 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
2025-04-16 16:17:42 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 16:17:42 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 16:17:42 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area
2025-04-16 16:17:43 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://www.cloudraylaser.com/products/cloudray-gm-100-litemarker-100w-fiber-laser-marking-engraver-with-4-3-x-4-3-scan-area in 0.93 seconds
2025-04-16 16:17:43 | INFO     | scrapers.price_extractor:_extract_from_common_selectors:244 - Extracted price 949.0 using selector '[data-price]'
2025-04-16 16:17:44 | WARNING  | services.database:update_machine_price:135 - No machine found with ID d3707433-2475-4b6c-8007-1e7126afd86c to update
2025-04-16 16:17:44 | ERROR    | services.price_service:update_machine_price:142 - Failed to update price in database for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 16:17:44 | ERROR    | api.routes:update_machine_price:58 - Price update failed for machine d3707433-2475-4b6c-8007-1e7126afd86c: Failed to update price in database for machine d3707433-2475-4b6c-8007-1e7126afd86c
2025-04-16 16:18:08 | INFO     | api.routes:update_machine_price:44 - Received price update request for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 16:18:08 | INFO     | services.price_service:update_machine_price:29 - Processing price update for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 16:18:09 | INFO     | scrapers.web_scraper:get_page_content:36 - Fetching content from https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser
2025-04-16 16:18:09 | INFO     | scrapers.web_scraper:get_page_content:48 - Fetched https://algolaser.com/products/algolaser-alpha-mk2-diode-laser-engraver-algolaser in 0.37 seconds
2025-04-16 16:18:09 | INFO     | scrapers.price_extractor:_extract_from_structured_data:125 - Extracted numeric price 649.0 using JSON-LD
2025-04-16 16:18:09 | INFO     | services.price_service:update_machine_price:107 - Price unchanged for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16: 649.0
2025-04-16 16:18:09 | INFO     | services.database:add_price_history:195 - Added price history entry for machine fad976a4-4bb9-4c91-92c3-ff774f02ec16
2025-04-16 16:18:10 | INFO     | api.routes:get_batches:281 - Fetching list of batch jobs
2025-04-16 16:18:10 | INFO     | api.routes:get_batches:298 - Found 1 batch jobs
2025-04-16 16:18:10 | INFO     | api.routes:get_batches:302 - Most recent batch: {'id': '2e001700-5ff3-4f7f-a8da-59e2dd133d43', 'status': 'completed', 'start_time': '2025-04-16T15:44:08.309528+00:00', 'end_time': '2025-04-16T15:45:15.526586+00:00', 'total_machines': 50, 'days_threshold': 0}
